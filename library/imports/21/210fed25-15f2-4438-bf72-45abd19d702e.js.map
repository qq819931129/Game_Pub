{"version":3,"sources":["..\\..\\..\\..\\assets\\js/assets\\js\\battle_Control.js"],"names":["js_dataControl","require","GroupName","cc","Class","extends","Component","properties","canvas","Node","itemPrefab","default","type","Prefab","choosePrefab","Prefab_obstacle_01","Prefab_obstacle_02","Prefab_obstacle_03","Prefab_hero_01","Prefab_hero_02","Prefab_tempColl_touch","background","batBox","other","enemy","icon_arrow","followSpeed","onLoad","battleInit_basic","checkId","personPrefabNew","batlist","children","hero_list","obstacle_list","hero_route_list","state","name","list","lastId","boxIndex","hero_route_ok_list","isState","isOOOK","indexNum","getcheckId","i","length","batItem","getComponent","batBoxName","bat_hero","point","groupId","console","log","perfabPool","init","battleInit_obstacle","otherList","y","x","j","bat_obstacle","battleInit_obstacle_detail","setObstacle","battleInit_hero","tempList","otherList_lock_id","otherList_lock_point","self","enemyList","id","push","pop","battleInit_hero_detail","updateHeroList","heroRouteOkList","getChildByName","on","EventType","TOUCH_START","event","selfItem","self_x","getLocation","self_y","heroList","route","slice","checkRoute","routeDirection","getNearEnemy","stopMove","currentBox","boxItem","temp","box_current","item","instantiate","addChild","setPosition","currentBox_destroy","child","destroy","box","itemList","createEnemy","group","empty","hero_basic","heroName","isDie","lastRouteTarget","tempColl_touch","TOUCH_MOVE","isCenter","parent","enemyList2","z","matchOKHeroRoute","TOUCH_CANCEL","touchStop","TOUCH_END","update","dt","targetBoxItem","end","v2","start","position","direction","pNormalize","pSub","pAdd","pMult","sum","pDistance","splice","repeatList","noRepeatList","ok_list","repeatIndex","repeatIndexItem","noRepeatIndex","repeat","temp_okItem","o","startTarget","endTarget","openList","closeList","sureList","isSure_start","isSure_end","minF","minG","isStart","G","H","F","directionList","setColor","color","tempEndTarget","obsExList","obsId_right","obsId_down","obsId_left","obsId_top","tempEnemyList","enemId_right","enemId_down","enemId_left","enemId_top","tempCheckTarget","checkTarget","isOpen","isClose","isObstacle","isObsEx","isEnemy","isEnemy2","H_x","Math","abs","H_y","label_G","addComponent","Label","fontSize","string","reverse","tempSureList","target","dataList"],"mappings":"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","file":"battle_Control.js","sourceRoot":"..\\..\\..\\..\\assets\\js","sourcesContent":["﻿//导入外部脚本\r\nvar js_dataControl = require(\"dataControl\");\r\nconst GroupName = require('Types').GroupName;\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        canvas: cc.Node,\r\n        itemPrefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        choosePrefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        Prefab_obstacle_01: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        Prefab_obstacle_02: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        Prefab_obstacle_03: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        Prefab_hero_01: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        Prefab_hero_02: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        Prefab_tempColl_touch: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        background: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        batBox: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        other: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        enemy: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        icon_arrow: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        followSpeed: 1\r\n    },\r\n    onLoad: function () {\r\n    \t\r\n    \t\r\n    },\r\n    //生成第一层战场数组-基础数据  (关卡id，预存资源对象)\r\n    battleInit_basic: function(checkId,personPrefabNew) {\r\n\t\t//初始化部分数组\r\n    \tthis.batlist = this.batBox.children;//-----------战场基础层  需要批量处理基础层格子数据时候用\r\n    \tthis.hero_list = [];//---------------------------战场英雄存储\r\n    \tthis.obstacle_list = [];//-----------------------战场障碍物存储\r\n    \tthis.hero_route_list = [];//---------------------英雄路线数据\r\n    \tthis.hero_route_list.state = 0;//----------------英雄路线——是否可启用 0=不可用，1=可用\r\n    \tthis.hero_route_list.name = null;//--------------英雄生成名字\r\n    \tthis.hero_route_list.list = [];//----------------英雄路线——存储路线数组\r\n    \tthis.hero_route_list.lastId = -1;//--------------英雄路线——记录上一次格子的名字  -1:初始     加入临时数组时进行赋值\r\n    \tthis.hero_route_list.boxIndex = -1;//------------英雄路线——记录格子下标   -1:初始   \r\n    \t\r\n    \tthis.hero_route_ok_list = [];//---------------------中心点英雄路线数据\r\n    \tthis.hero_route_ok_list.state = 0;//----------------中心点英雄路线——是否可启用 0=不可用，1=可用\r\n    \tthis.hero_route_ok_list.name = null;//--------------中心点英雄生成名字\r\n    \tthis.hero_route_ok_list.list = [];//----------------中心点英雄路线——存储路线数组\r\n    \tthis.hero_route_ok_list.lastId = -1;//--------------中心点英雄路线——记录上一次格子的名字  -1:初始     加入确认数组时进行赋值\r\n    \t\r\n    \tthis.isState = 0;\r\n    \tthis.isOOOK = 1;\r\n    \tthis.indexNum = 0;\r\n    \t\r\n    \tthis.checkId = js_dataControl.getcheckId();//-------获取关卡id\r\n\t\t//var bat = this.batBox.children;\r\n\t\tfor (let i = 0; i < this.batlist.length; i++) {\r\n\t\t\tvar batItem = this.batlist[i].getComponent(\"batBox_basic\");\r\n\t\t\t/*this.batlist.push(bat[i].getComponent(\"batBox_basic\"));\r\n\t\t\tthis.batlist[i].batBoxName = bat[i].name;\r\n\t\t\tthis.batlist[i].bat_hero = {point:null,groupId:null};*/\r\n\t\t\t\r\n\t\t\tbatItem.batBoxName = this.batlist[i].name;\r\n\t\t\tbatItem.bat_hero = {point:null,groupId:null};\r\n\t\t}\r\n\t\tconsole.log(this.batlist);\r\n        this.perfabPool = this.getComponent(\"prefabPool\");\r\n        this.perfabPool.init();\r\n\t\tthis.battleInit_obstacle(this.checkId,personPrefabNew);\r\n    },\r\n    //生成第二层战场数组-障碍物   (关卡id)\r\n    battleInit_obstacle: function(checkId,personPrefabNew){\r\n    \t//关卡序列\r\n    \tif (checkId == 1) {\r\n    \t\tvar otherList = [{y: 0,x: 4,point: 1},{y: 2,x: 4,point: 2},{y: 1,x: 4,point: 3},{y: 1,x: 6,point: 1},{y: 2,x: 7,point: 1}];\r\n    \t}\r\n    \tif (checkId == 2) {\r\n    \t\tvar otherList = [{y: 0,x: 4,point: 1},{y: 2,x: 4,point: 2},{y: 1,x: 4,point: 3}];\r\n    \t}\r\n    \tfor (let i = 0; i < otherList.length; i++) {//-----匹配战场数组\r\n    \t\tfor (let j = 0; j < this.batlist.length; j++) {//--------战场需要遍历50次，所以用batlist，而不用专门获取的batBox.getChildByName\r\n    \t\t\tvar batItem = this.batlist[j].getComponent(\"batBox_basic\");\r\n\t        \tif (batItem.x == otherList[i].x && batItem.y == otherList[i].y) {\r\n\t        \t\tbatItem.bat_obstacle = otherList[i].point;\r\n\t        \t\tthis.battleInit_obstacle_detail(otherList[i].point,batItem);\r\n\t        \t}\r\n    \t\t}\r\n    \t}\r\n    \tconsole.log(this.obstacle_list);\r\n    \tjs_dataControl.setObstacle(this.obstacle_list);\r\n    \tthis.battleInit_hero(this.checkId,personPrefabNew);\r\n    },\r\n    //生成第三层战场数组-英雄   (关卡id)\r\n    battleInit_hero: function(checkId,personPrefabNew){\r\n    \tlet tempList = [{y: 4,x: 2,point: 6},{y: 3,x: 2,point: 7},{y: 2,x: 2,point: 8},{y: 1,x: 2,point: 9},{y: 0,x: 2,point: 10},{y: 4,x: 1,point: 11}];//----我方阵容-测试用的\r\n\t\t//let tempList = [{y: 4,x: 2,point: 6}];\r\n\t\tlet otherList = [];//-----------------------我方阵容\r\n    \tlet otherList_lock_id = 0;//----------------我方阵容——位置是否有重复英雄导入标识  0:是，1:不是\r\n    \tlet otherList_lock_point = 0;//-------------我方阵容——不同年龄系列英雄是否重复导入标识  0:是，1:不是\r\n    \tvar self = this;\r\n    \t//let fulinList = [{id: \"01\",point: 1},{id: \"02\",point: 2},{id: \"03\",point: 3}];//------符灵技能栏\r\n    \tif (checkId == 1) {\r\n\t\t\t//var enemyList = [{y: 4,x: 9,point: 1},{y: 2,x: 9,point: 2},{y: 0,x: 9,point: 3},{y: 3,x: 7,point: 4},{y: 1,x: 7,point: 5}];//----敌方阵容\r\n\t\t\tvar enemyList = [{y: 3,x: 8,point: 1}];\r\n    \t}\r\n    \tif (checkId == 2) {\r\n    \t\tvar enemyList = [{y: 3,x: 9,point: 1},{y: 1,x: 9,point: 2},{y: 0,x: 9,point: 3},{y: 0,x: 7,point: 4},{y: 1,x: 7,point: 5}];//----敌方阵容\r\n    \t}\r\n    \tfor (let i = 0; i < tempList.length; i++) {\r\n    \t\t//我方阵容区域内\r\n    \t\tif (tempList[i].id == \"00\" || tempList[i].id == \"10\" || tempList[i].id == \"20\" || tempList[i].id == \"30\" || tempList[i].id == \"40\"\r\n    \t\t || tempList[i].id == \"01\" || tempList[i].id == \"11\" || tempList[i].id == \"21\" || tempList[i].id == \"31\" || tempList[i].id == \"41\"\r\n    \t\t || tempList[i].id == \"02\" || tempList[i].id == \"12\" || tempList[i].id == \"22\" || tempList[i].id == \"32\" || tempList[i].id == \"42\") {\r\n    \t\t \tif (otherList.length < 5) {//----------------------------不超出5个英雄选择\r\n    \t\t\t\tfor (let j = 0; j < otherList.length; j++) {\r\n\t    \t\t \t\tif (otherList[j].x == tempList[i].x && otherList[j].y == tempList[i].y) {//-------发现已有英雄的位置上再放英雄，标识此次操作不加入阵容数组\r\n\t    \t\t \t\t\totherList_lock_id = 1;\r\n\t    \t\t \t\t}\r\n\t    \t\t \t\tif (otherList[j].point == tempList[i].point) {//---------发现放了不同年龄系列英雄，一个英雄分不同年龄阶段的卡牌\r\n    \t\t \t\t\t\totherList_lock_point = 1;\r\n    \t\t \t\t\t}\r\n\t\t    \t\t}\r\n\t    \t\t}\r\n    \t\t}\r\n    \t\tif (otherList.length < 5) {//----------------------------不超出5个英雄选择\r\n\t    \t\tif (otherList_lock_id == 0 && otherList_lock_point == 0) {//------标识们一致允许加入才能增加\r\n\t    \t\t\totherList.push(tempList[i]);\r\n\t    \t\t}\r\n\t    \t\tif (otherList_lock_id == 1 || otherList_lock_point == 1) {//------标识们一致允许加入才能增加\r\n\t    \t\t\totherList.pop();\r\n\t    \t\t\totherList.push(tempList[i]);\r\n\t    \t\t}\r\n    \t\t}\r\n    \t\t//初始化临时用的标识值\r\n    \t\totherList_lock_id = 0;\r\n    \t\totherList_lock_point = 0;\r\n\t\t}\r\n\t\t\r\n    \tfor (let i = 0; i < otherList.length; i++) {//-----我方英雄导入战场\r\n    \t\tfor (let j = 0; j < this.batlist.length; j++) {//--------战场需要遍历50次，所以用batlist，而不用专门获取的batBox.getChildByName\r\n    \t\t\tvar batItem = this.batlist[j].getComponent(\"batBox_basic\");\r\n\t        \tif (batItem.x == otherList[i].x && batItem.y == otherList[i].y) {\r\n\t        \t\tbatItem.bat_hero = {\r\n\t        \t\t\tpoint: otherList[i].point,\r\n\t        \t\t\tgroupId: 1\r\n\t        \t\t}\r\n\t        \t\t//this.batBox.getChildByName(\"batBox_y\" + batItem.y + \"_x\" + batItem.x).bat_hero = batItem.bat_hero;\r\n\t        \t\tthis.battleInit_hero_detail(otherList[i].point,batItem,1,personPrefabNew);\r\n\t        \t}\r\n    \t\t}\r\n    \t}\r\n    \tfor (let i = 0; i < enemyList.length; i++) {//-----敌方英雄导入战场\r\n    \t\tfor (let j = 0; j < this.batlist.length; j++) {//--------战场需要遍历50次，所以用batlist，而不用专门获取的batBox.getChildByName\r\n    \t\t\tvar batItem = this.batlist[j].getComponent(\"batBox_basic\");\r\n\t        \tif (batItem.x == enemyList[i].x && batItem.y == enemyList[i].y) {\r\n\t        \t\tbatItem.bat_hero = {\r\n\t        \t\t\tpoint: enemyList[i].point,\r\n\t        \t\t\tgroupId: 2\r\n\t        \t\t}\r\n\t        \t\t//this.batBox.getChildByName(\"batBox_y\" + batItem.y + \"_x\" + batItem.x).bat_hero = batItem.bat_hero;\r\n\t        \t\tthis.battleInit_hero_detail(enemyList[i].point,batItem,2,personPrefabNew);\r\n\t        \t}\r\n    \t\t}\r\n    \t}\r\n    \t//console.log(this.batlist,this.batBox.getChildByName(\"batBox_y\" + 0 + \"_x\" + 2).getComponent(\"batBox_basic\"));\r\n    \t\r\n    \tjs_dataControl.updateHeroList(this.hero_list);\r\n\t\tvar heroRouteOkList = this.hero_route_ok_list;\r\n    \tthis.background.getChildByName(\"stopAllMove\").on(cc.Node.EventType.TOUCH_START, function ( event ) {\r\n\t\t\tlet selfItem = this;\r\n\t\t\tlet self_x = event.getLocation().x;\r\n\t\t\tlet self_y = event.getLocation().y;\r\n\t\t\tlet heroList = self.hero_list;\r\n\t\t\tfor (let j = 0; j < heroList.length; j++) {//---------匹配英雄表\r\n\t\t\t\theroList[j].route = heroList[j].route.slice(0,heroList[j].indexNum+1);\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.background.getChildByName(\"goAllMove\").on(cc.Node.EventType.TOUCH_START, function ( event ) {\r\n\t\t\tlet selfItem = this;\r\n\t\t\tlet self_x = event.getLocation().x;\r\n\t\t\tlet self_y = event.getLocation().y;\r\n\t\t\tlet heroList = self.hero_list;\r\n\t\t\tfor (let j = 0; j < heroList.length; j++) {//---------匹配英雄表\r\n\t\t\t\tif (heroList[j].groupId == 1) {\r\n\t\t\t\t//if (heroList[j].heroName == \"hero_6\") {\r\n\t\t\t\t\tlet checkRoute = self.routeDirection(heroList[j],self.getNearEnemy(heroList[j],heroList));\r\n\t\t\t\t\theroList[j].route = checkRoute;\r\n\t\t\t\t\theroList[j].state = 11;\r\n\t\t\t\t\theroList[j].indexNum = 0;\r\n\t\t\t\t\t//self.matchOKHeroRoute(heroList[j].name,self.getNearEnemy(heroList[j],heroList));//-------传参英雄名和格子对象给确认数组\r\n\t\t\t\t\tconsole.log(heroList[j],checkRoute,self.getNearEnemy(heroList[j],heroList));\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t});\r\n    },\r\n    stopMove:function (point) {\r\n    \tvar self = this;\r\n    \tlet heroList = self.hero_list;\r\n\t\tfor (let j = 0; j < heroList.length; j++) {//---------匹配英雄表\r\n\t\t\tif (heroList[j].point == point) {\r\n\t\t\t//if (heroList[j].heroName == \"hero_6\") {\r\n\t\t\t\tlet checkRoute = self.routeDirection(heroList[j],self.getNearEnemy(heroList[j],heroList));\r\n\t\t\t\theroList[j].route = checkRoute;\r\n\t\t\t\theroList[j].state = 11;\r\n\t\t\t\theroList[j].indexNum = 0;\r\n\t\t\t\t//lf.matchOKHeroRoute(heroList[j].name,self.getNearEnemy(heroList[j],heroList));//-------传参英雄名和格子对象给确认数组\r\n\t\t\t\t//console.log(heroList[j],checkRoute,self.getNearEnemy(heroList[j],heroList));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n    },\r\n    //选取格子高亮   (格子对象)\r\n    currentBox: function(boxItem){\r\n    \tvar temp = this.batBox.getChildByName(\"batBox_y\" + boxItem.y + \"_x\" + boxItem.x);\r\n    \t\r\n    \tconsole.log(temp.getComponent(\"batBox_basic\").box_current,temp.getComponent(\"batBox_basic\"));\r\n    \tif(temp.getComponent(\"batBox_basic\").box_current == 0){//------------------------------防止重复加载同一个格子高亮导致出现异常bug情况\r\n\t\t\ttemp.getComponent(\"batBox_basic\").box_current = 1;//-------------------------------高亮选择到的格子\r\n\t    \tlet item = cc.instantiate(this.icon_arrow); \r\n\t\t\ttemp.addChild(item);\r\n\t\t\titem.setPosition(boxItem.x,boxItem.y);\r\n\t    \titem.name = \"currentBox\";\r\n    \t}\r\n    },\r\n    //销毁高亮资源   (格子对象)\r\n    currentBox_destroy: function(boxItem){\r\n\t\tthis.batBox.getChildByName(\"batBox_y\" + boxItem.y + \"_x\" + boxItem.x).getComponent(\"batBox_basic\").box_current = 0;//----------------------清除高亮记录\r\n\t\tlet child = this.batBox.getChildByName(\"batBox_y\" + boxItem.y + \"_x\" + boxItem.x).getChildByName(\"currentBox\");\r\n\t\tif (child) { child.destroy(); }//--------------------------------------------------------------销毁高亮资源\r\n    },\r\n    //障碍物具体参数数组   (障碍物编号，格子对象)\r\n    battleInit_obstacle_detail: function(point,box){\r\n    \tif (point == 1) { var item = cc.instantiate(this.Prefab_obstacle_01); }\r\n    \tif (point == 2) { var item = cc.instantiate(this.Prefab_obstacle_02); }\r\n    \tif (point == 3) { var item = cc.instantiate(this.Prefab_obstacle_03); }\r\n    \tthis.batBox.getChildByName(\"batBox_y\" + box.y + \"_x\" + box.x).addChild(item);\r\n    \titem.setPosition(0,0);\r\n    \titem.name = \"point_\" + point;\r\n    \tvar itemList = {\r\n    \t\tx\t\t: box.x,\t\t\t\t//障碍物当前所处x轴\r\n    \t\ty\t\t: box.y,\t\t\t\t//障碍物当前所处y轴\r\n    \t}\r\n    \tthis.obstacle_list.push(itemList);\r\n    \t\r\n    },\r\n    //英雄具体参数数组   (英雄编号，格子对象，敌我英雄标识id: 1=我方   2=敌方)\r\n    battleInit_hero_detail: function(point,box,groupId,personPrefabNew){\r\n    \tif (point == 1) { var item = this.perfabPool.createEnemy(); }\r\n    \tif (point == 2) { var item = this.perfabPool.createEnemy(); }\r\n    \tif (point == 3) { var item = this.perfabPool.createEnemy(); }\r\n    \tif (point == 4) { var item = this.perfabPool.createEnemy(); }\r\n    \tif (point == 5) { var item = this.perfabPool.createEnemy(); }\r\n    \tif (point == 6) { var item = this.perfabPool.createEnemy(); }\r\n    \tif (point == 7) { var item = this.perfabPool.createEnemy(); }\r\n    \tif (point == 8) { var item = this.perfabPool.createEnemy(); }\r\n    \tif (point == 9) { var item = this.perfabPool.createEnemy(); }\r\n    \tif (point == 10) { var item = this.perfabPool.createEnemy(); }\r\n\t\tif (point == 11) { var item = this.perfabPool.createEnemy(); }\r\n\t\tif(groupId == 1){\r\n\t\t\titem.getComponent('person').group = GroupName.other\r\n\t\t\tthis.other.addChild(item);\r\n\t\t}\r\n\t\tif(groupId == 2){\r\n\t\t\titem.getComponent('person').group = GroupName.empty;\r\n\t\t\tthis.enemy.addChild(item);\r\n\t\t}\r\n\t\tvar x = this.batBox.getChildByName(\"batBox_y\" + box.y + \"_x\" + box.x).x;\r\n\t\tvar y = this.batBox.getChildByName(\"batBox_y\" + box.y + \"_x\" + box.x).y;\r\n    \titem.setPosition(x,y);\r\n    \titem.name = \"hero_\" + point;\r\n    \tif(groupId == 1){\r\n\t\t\tvar hero_basic = this.other.getChildByName(item.name).getComponent(\"person\");\r\n\t    \thero_basic.groupId = groupId;\r\n\t    \thero_basic.heroName = item.name;\r\n\t    \thero_basic.x = box.x;\r\n\t    \thero_basic.y = box.y;\r\n\t    \thero_basic.point = point;\r\n    \t}\r\n    \tif(groupId == 2){\r\n\t\t\tvar hero_basic = this.enemy.getChildByName(item.name).getComponent(\"person\");\r\n\t    \thero_basic.groupId = groupId;\r\n\t    \thero_basic.heroName = item.name;\r\n\t    \thero_basic.x = box.x;\r\n\t    \thero_basic.y = box.y;\r\n\t    \thero_basic.point = point;\r\n    \t}\r\n    \tlet itemList = {\r\n    \t\tgroupId : groupId,\t\t\t\t//英雄敌我阵容标识\r\n    \t\theroName: item.name,\t\t\t//英雄预存资源生成名称\r\n    \t\tx\t\t: box.x,\t\t\t\t//英雄当前所处x轴\r\n    \t\ty\t\t: box.y,\t\t\t\t//英雄当前所处y轴\r\n    \t\tpoint\t: point,\t\t\t\t//英雄标记  纪录具体是哪个英雄\r\n    \t\tindexNum: 0,\t\t\t\t\t//英雄移动路线的当前到达位置，就是说数组里的第几个位置\r\n    \t\troute\t: [],\t\t\t\t\t//英雄移动路线   状态切换为移动时，赋值路线\r\n\t\t\tstate\t: 10,\t\t\t\t\t//英雄状态   10：待命，11：移动\r\n\t\t\tisDie   : 1\t\t\t\t\t\t//死亡标识   0：死亡，1:未死亡\r\n    \t}\r\n    \tthis.hero_list.push(itemList);\r\n    \tvar self = this;\r\n\t\tvar heroRouteOkList = this.hero_route_ok_list;\r\n\t\tvar lastRouteTarget = null;//-------------------用作碰触到障碍物后保留前一个格子对象\r\n\t\tif(groupId == 1){\r\n\t\t\tthis.other.getChildByName(\"hero_\" + point).on(cc.Node.EventType.TOUCH_START, function ( event ) {\r\n\t\t\t\tlet selfItem = this;\r\n\t\t\t\t//console.log(selfItem);\r\n\t\t\t\tlet self_x = event.getLocation().x;\r\n\t\t\t\tlet self_y = event.getLocation().y;\r\n\t\t\t\tif (self.background.getChildByName(\"tempColl_touch\")) { self.background.getChildByName(\"tempColl_touch\").destroy();}//--------销毁之前生成的临时路线碰触点 \r\n\t\t\t\t//---生成临时路线碰触点   如果不重新生成，会出现触碰点一直碰着相同格子没反应的问题，例如不断触碰起点，碰撞系统好像如果不离开碰触体，就不会重新算碰撞到\r\n\t\t\t\tlet tempColl_touch = cc.instantiate(self.Prefab_tempColl_touch);\r\n\t\t\t\tself.background.addChild(tempColl_touch);\r\n\t\t\t\ttempColl_touch.setPosition(self_x,self_y);\r\n\t\t\t\tself.background.getChildByName(\"tempColl_touch\").getComponent(\"colliderListener\").boxItem = null;//---初始化碰撞点上的格子对象\r\n\t\t\t\t\r\n\t\t    \t/*if (heroRouteOkList.list.length != 0) {\r\n\t\t\t\t\tlet heroList = self.hero_list;\r\n\t\t\t\t\tfor (let j = 0; j < heroList.length; j++) {//---------匹配英雄表\r\n\t\t\t\t\t\tif(self.hero_list[j].heroName == selfItem.name){//--------------找出赋值英雄移动数组\r\n\t\t\t\t\t\t\tself.hero_list[j].state = 10;//------------------------------------英雄状态切换为：移动\r\n\t\t\t\t\t\t\tself.hero_list[j].route = heroRouteOkList.list;//------------------赋值路线\r\n\t\t\t\t\t\t\tself.hero_list[j].indexNum = 0;//----------------------------------初始化移动路线的到达位置\r\n\t\t\t\t\t\t\theroRouteOkList.list = [];//---------------------------临时路线清空\r\n\t\t\t\t\t\t\theroRouteOkList.state = 0;//---------------------------临时路线状态改为不启用\r\n\t\t\t\t\t\t\theroRouteOkList.name = null;//-------------------------临时路线的英雄名清除\r\n\t\t\t\t\t\t\theroRouteOkList.lastId = -1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}*/\r\n\t\t\t});\r\n\t\t\tthis.other.getChildByName(\"hero_\" + point).on(cc.Node.EventType.TOUCH_MOVE, function ( event ) {\r\n\t\t\t\tlet selfItem = this;\r\n\t\t\t\tlet self_x = event.getLocation().x;\r\n\t\t\t\tlet self_y = event.getLocation().y;\r\n\t\t\t\tself.background.getChildByName(\"tempColl_touch\").x = self_x;//-------实时更改临时路线碰触点位置\r\n\t\t\t\tself.background.getChildByName(\"tempColl_touch\").y = self_y;\r\n\t\t\t\tlet isCenter = 0;\r\n\t\t\t\tvar boxItem = self.background.getChildByName(\"tempColl_touch\").getComponent(\"colliderListener\").boxItem;\r\n\t\t\t\tif (boxItem) {\r\n\t\t\t\t\t//console.log(111);\r\n\t\t\t\t\tif (boxItem.name == \"batBox_Center\") {\r\n\t\t\t\t\t\tboxItem = boxItem.parent.getComponent(\"batBox_basic\");\r\n\t\t\t\t\t\tisCenter = 1;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tboxItem = boxItem.getComponent(\"batBox_basic\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar enemyList2 = [];\r\n\t    \t\t\tfor (var z = 0; z < self.hero_list.length; z++) {\r\n\t    \t\t\t\t//console.log(self.hero_list[z].point,boxItem.bat_hero.point);\r\n\t    \t\t\t\tif(self.hero_list[z].point == boxItem.bat_hero.point && self.hero_list[z].groupId == 2){//获取当前格子上是否有敌人\r\n\t    \t\t\t\t\tenemyList2.push(self.hero_list[z]);\r\n\t    \t\t\t\t}\r\n\t    \t\t\t}\r\n\t    \t\t\t\r\n\t    \t\t\t//console.log(enemyList2);\r\n\t\t\t\t\tif (!boxItem.bat_obstacle && enemyList2.length == 0) {\r\n\t\t\t\t\t\t//console.log(boxItem.batBoxName,heroRouteOkList.lastId);\r\n\t\t\t\t\t\tif (heroRouteOkList.lastId == -1) {//--------------------------------还没记录到上一次的格子名字，证明是在获取第一次路线信息\r\n\t\t\t\t\t\t\t//console.log(666);\r\n\t\t\t\t\t\t\tfor (let i = 0; i < self.hero_list.length; i++) {//------------循环英雄数组\r\n\t\t\t\t\t\t\t\tif (self.hero_list[i].heroName == selfItem.name) {//----------匹配当前点击的格子上是否存在英雄\r\n\t\t\t\t\t\t\t\t\t//console.log(333);\r\n\t\t\t\t\t\t\t\t\tself.matchOKHeroRoute(selfItem.name,boxItem);//-------传参英雄名和格子对象给确认数组\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tif (isCenter == 1) {\r\n\t\t\t\t\t\t\t\t//console.log(444);\r\n\t\t\t\t\t\t\t\tif(heroRouteOkList.lastId != boxItem.batBoxName){//----------当前触碰的格子不是上一次记录的格子（此判断为了防止不断触碰相同格子一直执行以下方法）\r\n\t\t\t\t\t\t\t\t\t//console.log(555);\r\n\t\t\t\t\t\t\t\t\tself.matchOKHeroRoute(heroRouteOkList.name,boxItem);//-------传参英雄名和格子对象给确认数组\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tthis.other.getChildByName(\"hero_\" + point).on(cc.Node.EventType.TOUCH_CANCEL, function ( event ) {\r\n\t\t\t\tlet self_x = event.getLocation().x;\r\n\t\t\t\tlet self_y = event.getLocation().y;\r\n\t\t\t\t//console.log(heroRouteOkList.list,heroRouteOkList.name);\r\n\t\t\t\tvar boxItem = self.background.getChildByName(\"tempColl_touch\").getComponent(\"colliderListener\").boxItem;\r\n\t\t\t\tif (boxItem.name == \"batBox_Center\") {\r\n\t\t\t\t\tboxItem = boxItem.parent.getComponent(\"batBox_basic\");\r\n\t\t\t\t}else{\r\n\t\t\t\t\tboxItem = boxItem.getComponent(\"batBox_basic\");\r\n\t\t\t\t}\r\n\t\t\t\tself.matchOKHeroRoute(heroRouteOkList.name,boxItem);//-------传参英雄名和格子对象给确认数组，有时越墙后也能填补后续路线\r\n\t\t\t\tself.touchStop();\r\n\t\t\t});\r\n\t\t\tthis.other.getChildByName(\"hero_\" + point).on(cc.Node.EventType.TOUCH_END, function ( event ) {\r\n\t\t\t\tlet self_x = event.getLocation().x;\r\n\t\t\t\tlet self_y = event.getLocation().y;\r\n\t\t\t\tvar boxItem = self.background.getChildByName(\"tempColl_touch\").getComponent(\"colliderListener\").boxItem;\r\n\t\t\t\tif (boxItem.name == \"batBox_Center\") {\r\n\t\t\t\t\tboxItem = boxItem.parent.getComponent(\"batBox_basic\");\r\n\t\t\t\t}else{\r\n\t\t\t\t\tboxItem = boxItem.getComponent(\"batBox_basic\");\r\n\t\t\t\t}\r\n\t\t\t\tself.matchOKHeroRoute(heroRouteOkList.name,boxItem);//-------传参英雄名和格子对象给确认数组，有时越墙后也能填补后续路线\r\n\t\t\t\tself.touchStop();\r\n\t\t\t});\r\n\t\t}\r\n    },\r\n    update: function (dt) {\r\n    \tlet self = this;\r\n\t\tlet heroList = self.hero_list;\r\n\t\tfor (let j = 0; j < heroList.length; j++) {//---------匹配英雄表\r\n\t\t\tif(heroList[j].state == 11){//--------------找出赋值英雄移动数组\r\n\t\t\t\tlet targetBoxItem = self.batBox.getChildByName(\"batBox_y\" + heroList[j].route[heroList[j].indexNum].y + \"_x\" + heroList[j].route[heroList[j].indexNum].x);\r\n\t\t\t\tlet end = cc.v2(targetBoxItem.x,targetBoxItem.y);//------------------------获取下个目标xy\r\n\t\t\t\tlet start = self.other.getChildByName(heroList[j].heroName).position;//-------------获取目标当前xy\r\n\t\t\t\tlet direction = cc.pNormalize(cc.pSub(end, start));//------------------------先获取俩个向量的差，然后返回一个长度为1的标准化后的向量\r\n\t\t\t\tlet item = cc.pAdd(start, cc.pMult(direction, self.followSpeed ));//----缩放上面的标准化向量，然后把初始目标xy加上缩放的向量\r\n\t\t\t\tself.other.getChildByName(heroList[j].heroName).setPosition(item);//----------------更新目标位置\r\n\t\t\t\tlet sum = cc.pDistance(start, end);\r\n\t\t\t\tif (sum <= 1 && heroList[j].indexNum < heroList[j].route.length) {//-----------------向量测出英雄和下一个格子中心在1范围内就进入下一个路线\r\n\t\t\t\t\theroList[j].x = targetBoxItem.getComponent(\"batBox_basic\").x;//----------------------------------------英雄当前x轴修改\r\n\t\t\t\t\theroList[j].y = targetBoxItem.getComponent(\"batBox_basic\").y;//----------------------------------------英雄当前y轴修改\r\n\t\t\t\t\tjs_dataControl.updateHeroList(heroList);//----------------更新存储数据层js的英雄详细数组\r\n\t\t\t\t\tif (heroList[j].route[heroList[j].indexNum-1]) {//清除当前移动对象上一步格子里的标识\r\n\t\t\t\t\t\tconsole.log(self.batBox.getChildByName(\"batBox_y\" + heroList[j].route[heroList[j].indexNum-1].y + \"_x\" + heroList[j].route[heroList[j].indexNum-1].x).getComponent(\"batBox_basic\").bat_hero);\r\n\t\t\t\t\t\tself.batBox.getChildByName(\"batBox_y\" + heroList[j].route[heroList[j].indexNum-1].y + \"_x\" + heroList[j].route[heroList[j].indexNum-1].x).getComponent(\"batBox_basic\").bat_hero.point = \"\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconsole.log(self.batBox.getChildByName(\"batBox_y\" + heroList[j].route[heroList[j].indexNum].y + \"_x\" + heroList[j].route[heroList[j].indexNum].x).getComponent(\"batBox_basic\"));\r\n\t\t\t\t\t\r\n\t\t\t\t\tself.batBox.getChildByName(\"batBox_y\" + heroList[j].route[heroList[j].indexNum].y + \"_x\" + heroList[j].route[heroList[j].indexNum].x).getComponent(\"batBox_basic\").bat_hero.point = heroList[j].point;//------更改第一层战场格子上的英雄标记\r\n\t\t\t\t\t//英雄路线移动完毕后执行以下方法\r\n\t\t\t\t\tif ((heroList[j].indexNum+1) == heroList[j].route.length) {\r\n\t\t\t\t\t\theroList[j].state = 10;\r\n\t\t\t\t\t\tconsole.log(self.batBox);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\theroList[j].indexNum++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n    },\r\n    //鼠标或手指碰触结束   (路线确认数组)\r\n    touchStop: function(){\r\n    \tvar self = this;\r\n\t\tvar heroRouteOkList = this.hero_route_ok_list;\r\n\t\tfor (let z = 0; z < heroRouteOkList.list.length; z++) {\r\n\t\t\tself.currentBox_destroy(heroRouteOkList.list[z]);//--------------------------销毁高亮资源方法\r\n\t\t}\r\n    \tif (heroRouteOkList.list.length != 0) {\r\n\t\t\tlet heroList = self.hero_list.length;\r\n\t\t\tfor (let j = 0; j < heroList; j++) {//---------匹配英雄表\r\n\t\t\t\tif(self.hero_list[j].heroName == heroRouteOkList.name){//--------------找出赋值英雄移动数组\r\n\t\t\t\t\tself.hero_list[j].state = 11;//------------------------------------英雄状态切换为：移动\r\n\t\t\t\t\tself.hero_list[j].route = heroRouteOkList.list;//------------------赋值路线\r\n\t\t\t\t\tself.hero_list[j].indexNum = 0;//----------------------------------初始化移动路线的到达位置\r\n\t\t\t\t\theroRouteOkList.list = [];//---------------------------临时路线清空\r\n\t\t\t\t\theroRouteOkList.state = 0;//---------------------------临时路线状态改为不启用\r\n\t\t\t\t\theroRouteOkList.name = null;//-------------------------临时路线的英雄名清除\r\n\t\t\t\t\theroRouteOkList.lastId = -1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n    },\r\n    //检测触碰到的英雄-确认   (英雄名,格子对象)\r\n    matchOKHeroRoute: function(heroName,boxItem){\r\n    \tlet heroRouteOkList = this.hero_route_ok_list;\r\n\t\theroRouteOkList.state = 1;//----------------------------------临时路线记录数组启用\r\n\t\theroRouteOkList.name = heroName;//----------------------------临时路线数组，记录英雄标识\r\n\t\theroRouteOkList.lastId = boxItem.batBoxName;//----------------赋值当前格子的名字\r\n\t\tif (heroRouteOkList.list.length == 0) {//-----------------------------已选格子不再执行以下方法\r\n    \t\tlet item = {\r\n    \t\t\tx\t: boxItem.x,\r\n    \t\t\ty\t: boxItem.y\r\n    \t\t}\r\n    \t\theroRouteOkList.list.push(item);\r\n\t\t\tthis.currentBox(boxItem);\r\n\t\t}else{\r\n\t\t\tlet z = -1;//--------------获取确认数组的最后一个格子id\r\n\t\t\t//---获取A*填充数组，条件是当前确认数组最后一个格子对象和最新所选到的格子对象，用作处理可能越几格的路线填充\r\n\t\t\tlet checkRoute = this.routeDirection(heroRouteOkList.list[heroRouteOkList.list.length-1],boxItem);\r\n\t\t\tconsole.log(checkRoute,heroRouteOkList.list);\r\n\t\t\tif (checkRoute) { checkRoute.splice(0,1); }//-----------清空A*返回的路线数组的第一个格子路线，因为会和旧路线最后一个格子重复了\r\n\t\t\tlet repeatList = [];//-----------------存储A*填充数组里和当前确认数组重复的格子对象，用作出现路线重复回滚\r\n\t\t\tlet noRepeatList = [];//---------------存储A*填充数组里不和当前确认数组不重复的格子对象，用作出现路线重复回滚时，可以继续填充路线\r\n\t\t\tlet ok_list = [];//--------------------临时存储确认数组的list\r\n\t\t\tlet repeatIndex = -1;//----------------记录A*填充数组最后一个格子下标   -1:初始   \r\n\t\t\tlet repeatIndexItem = null;//----------记录A*填充数组最后一个格子对象   -1:初始   \r\n\t\t\tlet noRepeatIndex = -1;//--------------记录回滚点是否触发的标识   1:是，2:否  \r\n\t\t\tfor (let i = 0; i < checkRoute.length; i++) {\r\n\t\t\t\tfor (let j = 0; j < heroRouteOkList.list.length; j++) {\r\n\t\t\t\t\tif (heroRouteOkList.list[j].x == checkRoute[i].x && heroRouteOkList.list[j].y == checkRoute[i].y) {\r\n\t\t\t\t\t\trepeatList.push(checkRoute[i]);\r\n\t\t\t\t\t\tcheckRoute[i].repeat = 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\theroRouteOkList.list.push(checkRoute[i]);\r\n\t\t\t\tthis.currentBox(this.batBox.getChildByName(\"batBox_y\" + checkRoute[i].y + \"_x\" + checkRoute[i].x).getComponent(\"batBox_basic\"));\r\n\t\t\t}\r\n\t\t\tconsole.log(repeatList,heroRouteOkList.list);\r\n\t\t\tif (repeatList.length > 0) {//-----------A*填充数组存在2个值时代表越墙或者终点不只在起点九宫格\r\n\t\t\t\tfor (let x = 0; x < heroRouteOkList.list.length; x++) {\r\n\t\t\t\t\tif (repeatIndex == -1) {//-----------------标识不存在时\r\n\t\t\t\t\t\tif (repeatList[repeatList.length-1].x == heroRouteOkList.list[x].x && repeatList[repeatList.length-1].y == heroRouteOkList.list[x].y) {//------当前格子id等于确认数组id时\r\n\t\t\t\t\t\t\trepeatIndex = x;//-----------------赋值标识为当前循环下标\r\n\t\t\t\t\t\t\trepeatIndexItem = this.batBox.getChildByName(\"batBox_y\" + heroRouteOkList.list[x].y + \"_x\" + heroRouteOkList.list[x].x).getComponent(\"batBox_basic\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tlet temp_okItem = this.batBox.getChildByName(\"batBox_y\" + heroRouteOkList.list[x].y + \"_x\" + heroRouteOkList.list[x].x).getComponent(\"batBox_basic\").batBoxName;\r\n\t\t\t\t\t\tconsole.log(repeatIndexItem.batBoxName , temp_okItem);\r\n\t\t\t\t\t\tif (repeatIndexItem.batBoxName != temp_okItem && noRepeatIndex == -1) {//还没检测到出现回滚点，就一直销毁前面的高亮路线\r\n\t\t\t\t\t\t\tthis.currentBox_destroy(heroRouteOkList.list[x]);//--------------------------销毁高亮资源方法\r\n\t\t\t\t\t\t}else{//-----------------------------------------------------------------检测到出现回滚点，停止销毁高亮路线，保留后续循环的路线，因为那些基本上是回滚后的新路线\r\n\t\t\t\t\t\t\tnoRepeatIndex = 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tfor (let o = 0; o < repeatIndex +1; o++) {//---循环不重复的下标+1的次数来获取确认数组路线\r\n\t\t\t\t\tlet item = {\r\n\t\t\t\t\t\tx\t: heroRouteOkList.list[o].x,\r\n\t\t\t\t\t\ty\t: heroRouteOkList.list[o].y\r\n\t\t\t\t\t}\r\n\t\t\t\t\tok_list.push(item);\r\n\t\t\t\t}\r\n\t\t\t\theroRouteOkList.list = ok_list;\r\n\t\t\t\tconsole.log(repeatIndex,heroRouteOkList.list);\r\n\t\t\t\tconsole.log(noRepeatList,repeatList);\r\n\t\t\t}\r\n\t\t}\r\n\t\t//console.log(heroRouteOkList.list);\r\n    },\r\n    //A*算法   (原点目标，终点目标)\r\n    routeDirection: function(startTarget,endTarget){\r\n    \tif (startTarget.x == endTarget.x && startTarget.y == endTarget.y || endTarget.bat_obstacle || endTarget.bat_hero.groupId == 2) { return false; }//---------------如果起点和终点一样就退出方法\r\n    \tlet openList = [];//---------------九宫格临时存放格子数组\r\n    \tlet closeList = [];//--------------九宫格临时存放确认数组\r\n    \tlet sureList = [];//---------------九宫格最终确认数组\r\n    \tlet isSure_start = 0;//------------是否到达终点   0：不是   1：是\r\n    \tlet isSure_end = 0;//--------------是否到达起点   0：不是   1：是\r\n    \tlet minF = 0;//--------------------F值最小值\r\n    \tlet minG = 0;//--------------------G值最小值\r\n    \tlet parent = {x: startTarget.x, y: startTarget.y, isStart: 1, G: 0, H:0, F:0};//-----------isStart: 起点的唯一标识\r\n    \topenList.push(parent);\r\n\t\t//方向数组  也可用作判断格子九宫格里其余格子是否在战场内数组   id：判断方向的数值   direction：上下左右斜方向值\r\n\t\tlet directionList = [{y:0,x:1,direction:1},{y:-1,x:1,direction:2},{y:-1,x:0,direction:3},{y:-1,x:-1,direction:4},{y:0,x:-1,direction:5},{y:1,x:-1,direction:6},{y:1,x:0,direction:7},{y:1,x:1,direction:8}];\r\n\t\tthis.batBox.getChildByName(\"batBox_y\" + startTarget.y + \"_x\" + startTarget.x).setColor(cc.color(\"#008102\"));//-----测试阶段，上颜色标识用\r\n\t\tthis.batBox.getChildByName(\"batBox_y\" + endTarget.y + \"_x\" + endTarget.x).setColor(cc.color(\"#fff\"));//-----测试阶段，上颜色标识用\r\n\t\tvar tempEndTarget = this.batBox.getChildByName(\"batBox_y\" + endTarget.y + \"_x\" + endTarget.x).getComponent(\"batBox_basic\");\r\n\t\tfor (let j = 0; j < openList.length; j++) {\r\n\t\t\tif (isSure_start == 1) { break; }//----------已到达终点，退出循环\r\n\t\t\t//console.log(j+\"——————————————————————————————————————————————————\");\r\n\t\t\t//console.log(parent,openList[j]);\r\n\t\t\tlet obsExList = [];//--------------障碍物上下左右格子的数组\r\n    \t\tlet obsId_right = null;//----------当前障碍物格子的右侧格子--临时禁止加入临时数组\r\n    \t\tlet obsId_down = null;//-----------当前障碍物格子的下侧格子--临时禁止加入临时数组\r\n    \t\tlet obsId_left = null;//-----------当前障碍物格子的左侧格子--临时禁止加入临时数组\r\n    \t\tlet obsId_top = null;//------------当前障碍物格子的上侧格子--临时禁止加入临时数组\r\n\t    \tvar tempEnemyList = [];\r\n    \t\tlet enemId_right = null;//----------当前敌人格子的右侧格子--临时禁止加入临时数组\r\n    \t\tlet enemId_down = null;//-----------当前敌人格子的下侧格子--临时禁止加入临时数组\r\n    \t\tlet enemId_left = null;//-----------当前敌人格子的左侧格子--临时禁止加入临时数组\r\n    \t\tlet enemId_top = null;//------------当前敌人格子的上侧格子--临时禁止加入临时数组\r\n\t\t\tfor (let i = 0; i < directionList.length; i++) {//------------------获取路线障碍物上下左右格子的数组\r\n\t\t\t\t//计算出九宫格内当前循环的格子是否在战场内  原理：利用格子的行列值进行运算，得出结果异常则不属于战场内格子\r\n\t    \t\tlet tempCheckTarget = this.batBox.getChildByName(\"batBox_y\" + (parent.y + directionList[i].y) + \"_x\" + (parent.x + directionList[i].x));\r\n\t\t\t\tif (tempCheckTarget) {//----------是否存在格子\r\n\t\t\t\t\tvar checkTarget = tempCheckTarget.getComponent(\"batBox_basic\");\r\n\t    \t\t\tif (checkTarget.bat_obstacle) {//---------------------当前循环九宫格格子是障碍物\r\n\t    \t\t\t\tif (i == 0 || i == 2 || i == 4 || i == 6) {\r\n\t    \t\t\t\t\tobsId_right = {y:(checkTarget.y + directionList[0].y),x:(checkTarget.x + directionList[0].x)};\r\n\t    \t\t\t\t\tobsId_down = {y:(checkTarget.y + directionList[2].y),x:(checkTarget.x + directionList[2].x)};\r\n\t    \t\t\t\t\tobsId_left = {y:(checkTarget.y + directionList[4].y),x:(checkTarget.x + directionList[4].x)};\r\n\t    \t\t\t\t\tobsId_top = {y:(checkTarget.y + directionList[6].y),x:(checkTarget.x + directionList[6].x)};\r\n\t    \t\t\t\t\tobsExList.push(obsId_right,obsId_down,obsId_left,obsId_top);\r\n\t    \t\t\t\t}\r\n\t    \t\t\t}\r\n\t    \t\t\tvar enemyList2 = [];\r\n\t    \t\t\tfor (var z = 0; z < this.hero_list.length; z++) {\r\n\t    \t\t\t\tif(this.hero_list[z].point == checkTarget.bat_hero.point && this.hero_list[z].groupId == 2){\r\n\t    \t\t\t\t\tenemyList2.push(this.hero_list[z]);\r\n\t    \t\t\t\t}\r\n\t    \t\t\t}\r\n\t    \t\t\tif (enemyList2) {\r\n\t    \t\t\t\tif (i == 0 || i == 2 || i == 4 || i == 6) {\r\n\t    \t\t\t\t\tenemId_right = {y:(checkTarget.y + directionList[0].y),x:(checkTarget.x + directionList[0].x)};\r\n\t    \t\t\t\t\tenemId_down = {y:(checkTarget.y + directionList[2].y),x:(checkTarget.x + directionList[2].x)};\r\n\t    \t\t\t\t\tenemId_left = {y:(checkTarget.y + directionList[4].y),x:(checkTarget.x + directionList[4].x)};\r\n\t    \t\t\t\t\tenemId_top = {y:(checkTarget.y + directionList[6].y),x:(checkTarget.x + directionList[6].x)};\r\n\t    \t\t\t\t\ttempEnemyList.push(enemId_right,enemId_down,enemId_left,enemId_top);\r\n\t    \t\t\t\t}\r\n\t    \t\t\t}\r\n\t    \t\t}\r\n\t\t\t}\r\n\t    \tfor (let i = 0; i < directionList.length; i++) {//------------------获取路线临时数组\r\n\t    \t\tlet isOpen = 0;//------------------是否已记录在临时数组标识   0：不是   1：是\r\n\t    \t\tlet isClose = 0;//-----------------是否已记录在确认数组标识   0：不是   1：是\r\n\t    \t\tlet isObstacle = 0;//--------------是否障碍物   0：不是   1：是\r\n\t    \t\tlet isObsEx = 0;//-----------------当前格子是否位于障碍物格子上下左右侧的格子位置上，用于判断是否处于斜格处理   0：不是   1：是\r\n\t    \t\tvar isEnemy = false;\r\n\t    \t\tvar isEnemy2 = 0;\r\n\t    \t\t//计算出九宫格内当前循环的格子  原理：利用格子的行列值进行运算，得出结果异常则不属于战场内格子\r\n\t    \t\tlet tempCheckTarget = this.batBox.getChildByName(\"batBox_y\" + (parent.y + directionList[i].y) + \"_x\" + (parent.x + directionList[i].x));\r\n\t    \t\tif (tempCheckTarget) {//----------是否存在格子\r\n\t\t\t\t\tvar checkTarget = tempCheckTarget.getComponent(\"batBox_basic\");\r\n\t\t\t\t\tvar enemyList2 = [];\r\n\t    \t\t\tfor (var z = 0; z < this.hero_list.length; z++) {\r\n\t    \t\t\t\tif(this.hero_list[z].point == checkTarget.bat_hero.point && this.hero_list[z].groupId == 2){\r\n\t    \t\t\t\t\tenemyList2.push(this.hero_list[z]);\r\n\t    \t\t\t\t}\r\n\t    \t\t\t}\r\n\t    \t\t\tif (checkTarget.bat_obstacle) {//---------------------当前循环九宫格格子是障碍物\r\n\t    \t\t\t\tisObstacle = 1;\r\n\t    \t\t\t}else if(enemyList2.length != 0){\r\n\t    \t\t\t\tisEnemy = true;\r\n\t    \t\t\t}else{\r\n\t\t    \t\t\tfor (let x = 0; x < closeList.length; x++) {//------------------当前循环九宫格格子是否已记录在确认数组\r\n\t\t\t    \t\t\tif (checkTarget.x == closeList[x].x && checkTarget.y == closeList[x].y) {\r\n\t\t\t    \t\t\t\tisClose = 1;\r\n\t\t\t    \t\t\t\tbreak;\r\n\t\t\t    \t\t\t}\r\n\t\t\t    \t\t}\r\n\t\t    \t\t\tfor (let x = 0; x < openList.length; x++) {//-------------------当前循环九宫格格子是否已记录在临时数组\r\n\t\t\t    \t\t\tif (checkTarget.x == openList[x].x && checkTarget.y == openList[x].y) {\r\n\t\t\t    \t\t\t\tisOpen = 1;\r\n\t\t\t    \t\t\t\tbreak;\r\n\t\t\t    \t\t\t}\r\n\t\t\t    \t\t}\r\n\t\t    \t\t\tfor (let o = 0; o < obsExList.length; o++) {//------------------当前循环九宫格格子是否位于障碍物格子上下左右侧的格子位置上，是的话就不能纳入赋值ghf处理\r\n\t    \t\t\t\t\tif (checkTarget.x == obsExList[o].x && checkTarget.y == obsExList[o].y) {\r\n\t\t    \t\t\t\t\tisObsEx = 1;\r\n\t\t    \t\t\t\t\tbreak;\r\n\t\t    \t\t\t\t}\r\n\t    \t\t\t\t}\r\n\t\t    \t\t\tfor (let o = 0; o < tempEnemyList.length; o++) {//------------------当前循环九宫格格子是否位于障碍物格子上下左右侧的格子位置上，是的话就不能纳入赋值ghf处理\r\n\t    \t\t\t\t\tif (checkTarget.x == tempEnemyList[o].x && checkTarget.y == tempEnemyList[o].y) {\r\n\t\t    \t\t\t\t\tisEnemy2 = 1;\r\n\t\t    \t\t\t\t\tbreak;\r\n\t\t    \t\t\t\t}\r\n\t    \t\t\t\t}\r\n\t    \t\t\t}\r\n\t    \t\t\tif (isClose == 0 && isOpen == 0 && isObstacle == 0 && isObsEx == 0 && !isEnemy && isEnemy2 == 0) {//-------------如任何检查判断为未触发，则视为当前格子是新处理格子\r\n\t\t\t\t\t\tlet H_x = Math.abs(tempEndTarget.x - checkTarget.x);\r\n\t\t\t\t\t\tlet H_y = Math.abs(tempEndTarget.y - checkTarget.y);\r\n\t\t\t\t\t\tlet H = (H_x + H_y) * 10;\r\n\t\t\t\t\t\tlet G;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif(i == 0 || i == 2 || i == 4 || i == 6){\r\n\t\t\t\t\t\t\tG = 10 + parent.G;\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tG = 14 + parent.G;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlet item = {\r\n\t\t\t\t\t\t\tx: checkTarget.x,\r\n\t\t\t\t\t\t\ty: checkTarget.y,\r\n\t\t\t\t    \t\tG: G,//--------------------------------从起点 A 移动到指定方格的移动代价，沿着到达该方格而生成的路径。\r\n\t\t\t\t    \t\tH: H,//--------------------------------从指定的方格移动到终点 B 的估算成本\r\n\t\t\t\t    \t\tF: G+H,\r\n\t\t\t\t    \t\tdirection: directionList[i].direction\r\n\t\t\t\t\t\t}\r\n\t\t\t\t        let label_G = new cc.Node();\r\n\t\t\t\t        label_G.addComponent(cc.Label);\r\n\t\t\t\t        label_G.getComponent(cc.Label).fontSize = 12\r\n\t\t\t\t        label_G.getComponent(cc.Label).string = (checkTarget.y + \"\" + checkTarget.x)+ \"，F：\"+(G+H)+  \"\\nG:\"+G+\"，H:\"+H;\r\n\t\t\t\t        tempCheckTarget.addChild(label_G);\r\n\t\t\t\t\t\topenList.push(item);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t    \tif (openList[0].isStart == 1) {//-----------处理起点的首次增删数组操作\r\n\t    \t\tcloseList.push(openList[0]);\r\n\t\t\t\topenList.splice(0,1);\r\n\t\t\t\tj = -1;//-------------------------------初始化循环次数\r\n\t    \t}\r\n\t    \tfor (let i = 0; i < openList.length; i++) {//----------循环取F值最小值\r\n\t    \t\tif (openList[i] && minF == 0) {//------------------------为了排除可能会遇到没F值的父格子，当存在的F值的循环才初始化\r\n\t    \t\t\tminF = openList[i];\r\n\t    \t\t}\r\n\t    \t\tif (minF.F > openList[i].F) {\r\n\t    \t\t\tminF = openList[i];\r\n\t    \t\t}\r\n\t    \t}\r\n\t    \tfor (let i = 0; i < openList.length; i++) {//----------依靠最新的F值最小值格子得出新的父节点\r\n\t    \t\tif (openList[i].F == minF.F) {\r\n\t    \t\t\tparent = openList[i];\r\n\t    \t\t\tcloseList.push(openList[i]);\r\n\t    \t\t\topenList.splice(i,1);\r\n\t    \t\t\tj = -1;//-------------------------------初始化循环次数\r\n\t    \t\t\tminF = 0;//-----------初始化F值最小值\r\n\t    \t\t}\r\n\t    \t}\r\n\t    \tif (parent.x == tempEndTarget.x && parent.y == tempEndTarget.y) {//---------------如果临时确认数组收录了终点，就退出循环\r\n\t\t\t\tisSure_start = 1;\r\n\t\t\t}\r\n    \t}\r\n\t\tfor (let j = 0; j < closeList.length; j++) {\r\n\t\t\tthis.batBox.getChildByName(\"batBox_y\" + closeList[j].y + \"_x\" + closeList[j].x).setColor(cc.color(\"#008102\"));//-----测试阶段，上颜色标识用\r\n\t\t}\r\n\t\tcloseList = closeList.reverse();\r\n\t\tsureList.push(parent);\r\n\t\t//计算最终路线    原理：从临时确认数组中反过来走到起点\r\n\t\tfor (let j = 0; j < closeList.length; j++) {\r\n\t\t\tif (isSure_end == 1) { break; }//----------已回到起点，退出循环\r\n\t\t\tlet obsExList = [];//--------------障碍物上下左右格子的数组\r\n    \t\tlet obsId_right = null;//----------当前障碍物格子的右侧格子--临时禁止加入临时数组\r\n    \t\tlet obsId_down = null;//-----------当前障碍物格子的下侧格子--临时禁止加入临时数组\r\n    \t\tlet obsId_left = null;//-----------当前障碍物格子的左侧格子--临时禁止加入临时数组\r\n    \t\tlet obsId_top = null;//------------当前障碍物格子的上侧格子--临时禁止加入临时数组\r\n    \t\tlet tempSureList = [];\r\n    \t\t\r\n\t    \tvar tempEnemyList = [];\r\n    \t\tlet enemId_right = null;//----------当前敌人格子的右侧格子--临时禁止加入临时数组\r\n    \t\tlet enemId_down = null;//-----------当前敌人格子的下侧格子--临时禁止加入临时数组\r\n    \t\tlet enemId_left = null;//-----------当前敌人格子的左侧格子--临时禁止加入临时数组\r\n    \t\tlet enemId_top = null;//------------当前敌人格子的上侧格子--临时禁止加入临时数组\r\n\t\t\tconsole.log(j+\"——————————————————————————————————————————————————\");\r\n\t\t\tfor (let i = 0; i < directionList.length; i++) {\r\n\t\t\t\t//获取当前循环的父节点格子  \r\n\t    \t\tlet tempCheckTarget = this.batBox.getChildByName(\"batBox_y\" + (parent.y + directionList[i].y) + \"_x\" + (parent.x + directionList[i].x));\r\n\t    \t\tif (tempCheckTarget) {//----------是否存在格子\r\n\t\t\t\t\tvar checkTarget = tempCheckTarget.getComponent(\"batBox_basic\");\r\n\t    \t\t\tif (checkTarget.bat_obstacle) {//---------------------当前循环九宫格格子是障碍物\r\n\t    \t\t\t\tif (i == 0 || i == 2 || i == 4 || i == 6) {\r\n\t    \t\t\t\t\tobsId_right = {y:(checkTarget.y + directionList[0].y),x:(checkTarget.x + directionList[0].x)};\r\n\t    \t\t\t\t\tobsId_down = {y:(checkTarget.y + directionList[2].y),x:(checkTarget.x + directionList[2].x)};\r\n\t    \t\t\t\t\tobsId_left = {y:(checkTarget.y + directionList[4].y),x:(checkTarget.x + directionList[4].x)};\r\n\t    \t\t\t\t\tobsId_top = {y:(checkTarget.y + directionList[6].y),x:(checkTarget.x + directionList[6].x)};\r\n\t    \t\t\t\t\tobsExList.push(obsId_right,obsId_down,obsId_left,obsId_top);\r\n\t    \t\t\t\t}\r\n\t    \t\t\t}\r\n\t    \t\t}\r\n    \t\t\tvar enemyList2 = [];\r\n    \t\t\tfor (var z = 0; z < this.hero_list.length; z++) {\r\n    \t\t\t\tif(this.hero_list[z].point == checkTarget.bat_hero.point && this.hero_list[z].groupId == 2){\r\n    \t\t\t\t\tenemyList2.push(this.hero_list[z]);\r\n    \t\t\t\t}\r\n    \t\t\t}\r\n    \t\t\tif (enemyList2) {\r\n    \t\t\t\tif (i == 0 || i == 2 || i == 4 || i == 6) {\r\n    \t\t\t\t\tenemId_right = {y:(checkTarget.y + directionList[0].y),x:(checkTarget.x + directionList[0].x)};\r\n    \t\t\t\t\tenemId_down = {y:(checkTarget.y + directionList[2].y),x:(checkTarget.x + directionList[2].x)};\r\n    \t\t\t\t\tenemId_left = {y:(checkTarget.y + directionList[4].y),x:(checkTarget.x + directionList[4].x)};\r\n    \t\t\t\t\tenemId_top = {y:(checkTarget.y + directionList[6].y),x:(checkTarget.x + directionList[6].x)};\r\n    \t\t\t\t\ttempEnemyList.push(enemId_right,enemId_down,enemId_left,enemId_top);\r\n    \t\t\t\t}\r\n    \t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (let i = 0; i < directionList.length; i++) {\r\n\t    \t\tlet isClose = 0;//-----------------是否已记录在确认数组标识   0：不是   1：是\r\n\t    \t\tlet isObstacle = 0;//--------------是否障碍物   0：不是   1：是\r\n\t    \t\tlet isObsEx = 0;//-----------------当前格子是否位于障碍物格子上下左右侧的格子位置上，用于判断是否处于斜格处理   0：不是   1：是\r\n\t\t\t\tvar isEnemy = false;\r\n\t    \t\tvar isEnemy2 = 0;\r\n\t\t\t\tlet tempCheckTarget = this.batBox.getChildByName(\"batBox_y\" + (parent.y + directionList[i].y) + \"_x\" + (parent.x + directionList[i].x));\r\n\t    \t\tif (tempCheckTarget) {//----------是否存在格子\r\n\t    \t\t\tvar checkTarget = tempCheckTarget.getComponent(\"batBox_basic\");\r\n\t    \t\t\tif (checkTarget.bat_obstacle) {//---------------------当前循环九宫格格子是障碍物\r\n\t    \t\t\t\tisObstacle = 1;\r\n\t    \t\t\t}else if(enemyList2.length != 0){\r\n\t    \t\t\t\tisEnemy = true;\r\n\t    \t\t\t}else{\r\n\t    \t\t\t\tfor (let x = 0; x < closeList.length; x++) {//------------------当前循环九宫格格子是否已记录在确认数组\r\n\t\t\t    \t\t\tif (checkTarget.x == closeList[x].x && checkTarget.y == closeList[x].y) {\r\n\t\t\t    \t\t\t\tfor (let o = 0; o < obsExList.length; o++) {//------------------当前循环九宫格格子是否位于障碍物格子上下左右侧的格子位置上，是的话就不能纳入赋值ghf处理\r\n\t\t\t    \t\t\t\t\tif (checkTarget.x == obsExList[o].x && checkTarget.y == obsExList[o].y) {\r\n\t\t\t\t    \t\t\t\t\tisObsEx = 1;\r\n\t\t\t\t    \t\t\t\t\tbreak;\r\n\t\t\t\t    \t\t\t\t}\r\n\t\t\t    \t\t\t\t}\r\n\t\t\t\t    \t\t\tfor (let o = 0; o < tempEnemyList.length; o++) {//------------------当前循环九宫格格子是否位于障碍物格子上下左右侧的格子位置上，是的话就不能纳入赋值ghf处理\r\n\t\t\t    \t\t\t\t\tif (checkTarget.x == tempEnemyList[o].x && checkTarget.y == tempEnemyList[o].y) {\r\n\t\t\t\t    \t\t\t\t\tisEnemy2 = 1;\r\n\t\t\t\t    \t\t\t\t\tbreak;\r\n\t\t\t\t    \t\t\t\t}\r\n\t\t\t    \t\t\t\t}\r\n\t\t\t    \t\t\t\tif (isObsEx == 0 && isEnemy2 == 0) {\r\n\t\t\t    \t\t\t\t\ttempSureList.push(closeList[x]);\r\n\t\t\t    \t\t\t\t}\r\n\t\t\t    \t\t\t}\r\n\t\t\t    \t\t}\r\n\t    \t\t\t}\r\n\t    \t\t}\r\n\t\t\t}\r\n\t\t\tfor (let i = 0; i < tempSureList.length; i++) {//----------循环取F值最小值\r\n\t    \t\tif (tempSureList[i] && minG == 0) {//------------------------为了排除可能会遇到没G值的父格子，当存在的G值的循环才初始化\r\n\t    \t\t\tminG = tempSureList[i];\r\n\t    \t\t}\r\n\t    \t\tif (minG.G > tempSureList[i].G) {\r\n\t    \t\t\tminG = tempSureList[i];\r\n\t    \t\t}\r\n\t    \t}\r\n\t    \tfor (let i = 0; i < tempSureList.length; i++) {//----------依靠最新的G值最小值格子得出新的父节点\r\n\t    \t\tif (tempSureList[i].G == minG.G) {\r\n\t    \t\t\tparent = tempSureList[i];\r\n\t    \t\t\tsureList.push(tempSureList[i]);\r\n\t    \t\t\tminG = 0;//-----------初始化G值最小值\r\n\t    \t\t}\r\n\t    \t}\r\n\t\t\tif (parent.x == startTarget.x && parent.y == startTarget.y) {//---------------如果临时确认数组收录了起点，就退出循环\r\n\t\t\t\tisSure_end = 1;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (let j = 0; j < sureList.length; j++) {\r\n\t\t\tthis.batBox.getChildByName(\"batBox_y\" + sureList[j].y + \"_x\" + sureList[j].x).setColor(cc.color(\"#bbb\"));//-----测试阶段，上颜色标识用\r\n\t\t}\r\n\t\t//console.log(sureList,closeList);\r\n\t\treturn sureList.reverse();\r\n    },\r\n    //获取最近敌人\r\n    getNearEnemy: function(target,dataList){\r\n    \tlet tempList = [];\r\n    \tlet enemyList = [];\r\n    \tvar minF = 0;\r\n    \tfor (let i = 0; i < dataList.length; i++) {\r\n    \t\tif (dataList[i].groupId == 2) {\r\n\t\t    \tlet H_x = Math.abs(dataList[i].x - target.x);\r\n\t\t\t\tlet H_y = Math.abs(dataList[i].y - target.y);\r\n\t\t\t\tlet H = (H_x + H_y) * 10;\r\n\t\t\t\tlet G = 0;\r\n\t\t\t\tlet item = {\r\n\t\t\t\t\tx: dataList[i].x,\r\n\t\t\t\t\ty: dataList[i].y,\r\n\t\t    \t\tG: G,//--------------------------------从起点 A 移动到指定方格的移动代价，沿着到达该方格而生成的路径。\r\n\t\t    \t\tH: H,//--------------------------------从指定的方格移动到终点 B 的估算成本\r\n\t\t    \t\tF: G+H\r\n\t\t\t\t}\r\n\t\t\t\ttempList.push(item);\r\n    \t\t\tenemyList.push(dataList[i]);\r\n    \t\t}\r\n    \t}\r\n    \tfor (let i = 0; i < tempList.length; i++) {\r\n    \t\tif (tempList[i].F && minF == 0) {//------------------------为了排除可能会遇到没F值的父格子，当存在的F值的循环才初始化\r\n    \t\t\tminF = tempList[i];\r\n    \t\t}\r\n    \t\tif (minF.F > tempList[i].F) {\r\n    \t\t\tminF = tempList[i];\r\n    \t\t}\r\n    \t}\r\n    \treturn minF;\r\n    },\r\n});\r\n"]}