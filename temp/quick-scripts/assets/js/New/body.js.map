{"version":3,"sources":["body.js"],"names":["AttackType","require","cc","Class","extends","Component","properties","person","default","type","Node","onLoad","update","init","animHelper","getComponent","parentCopm","director","getCollisionManager","enabled","enabledDrawBoundingBox","node","group","parent","log","attackOver","atkTarget","activeInHierarchy","die","atkType","Melee","damagePoint","atkPoint","damage","createFlyer","moveOver","playAttack","playMove","getAnimState","onCollisionEnter","other","self","demage"],"mappings":";;;;;;AAAA,IAAMA,aAAaC,QAAQ,OAAR,EAAiBD,UAApC;AACAE,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACTC,gBAAO,EAAE;AACJC,qBAAS,IADP;AAEFC,kBAAMP,GAAGQ;AAFP;AADE,KAHP;AASLC,YAAQ,kBAAY,CAEnB,CAXI;AAYLC,YAAQ,kBAAY,CAEnB,CAdI;AAeLC,UAAK,gBAAU;AACX,aAAKC,UAAL,GAAkB,KAAKC,YAAL,CAAkB,YAAlB,CAAlB;AACA,aAAKC,UAAL,GAAkB,KAAKT,MAAL,CAAYQ,YAAZ,CAAyB,QAAzB,CAAlB;;AAEA;AACAb,WAAGe,QAAH,CAAYC,mBAAZ,GAAkCC,OAAlC,GAA4C,IAA5C;AACA;AACAjB,WAAGe,QAAH,CAAYC,mBAAZ,GAAkCE,sBAAlC,GAA2D,IAA3D;AACA,aAAKC,IAAL,CAAUC,KAAV,GAAkB,KAAKD,IAAL,CAAUE,MAAV,CAAiBD,KAAnC;AACApB,WAAGsB,GAAH,CAAO,KAAKH,IAAL,CAAUC,KAAjB;AACH,KAzBI;AA0BLG,gBAAY,sBAAY;AACpB,YAAI,KAAKT,UAAL,CAAgBU,SAAhB,IAA6B,IAA7B,IACG,CAAC,KAAKV,UAAL,CAAgBU,SAAhB,CAA0BC,iBAD9B,IAEG,KAAKX,UAAL,CAAgBU,SAAhB,CAA0BE,GAA1B,IAAiC,CAFxC,EAE2C;AACvC;AACH;AACD,YAAG,KAAKZ,UAAL,CAAgBa,OAAhB,IAA2B7B,WAAW8B,KAAzC,EAA+C;AAC3C,gBAAIC,cAAc,KAAKf,UAAL,CAAgBgB,QAAlC,CAD2C,CACC;AAC5C,iBAAKhB,UAAL,CAAgBU,SAAhB,CAA0BX,YAA1B,CAAuC,QAAvC,EAAiDkB,MAAjD,CAAwDF,WAAxD;AACH,SAHD,MAGK;AACD,iBAAKf,UAAL,CAAgBkB,WAAhB;AACH;AACJ,KAtCI;AAuCLC,cAAU,oBAAY;AAClB;AACH,KAzCI;;AA2CLC,gBAAW,sBAAU;AACjB,aAAKtB,UAAL,CAAgBsB,UAAhB;AACH,KA7CI;;AA+CLC,cAAS,oBAAU;AACf,aAAKvB,UAAL,CAAgBuB,QAAhB;AACH,KAjDI;;AAmDLC,kBAAa,wBAAU;AACnB,aAAKxB,UAAL,CAAgBwB,YAAhB;AACH,KArDI;AAsDL;;;;;AAKAC,sBAAkB,0BAAUC,KAAV,EAAiBC,IAAjB,EAAuB;AACrC,YAAIC,SAASF,MAAMnB,IAAN,CAAWN,YAAX,CAAwB,WAAxB,EAAqCkB,MAAlD;AACA,aAAKjB,UAAL,CAAgBU,SAAhB,CAA0BX,YAA1B,CAAuC,QAAvC,EAAiDkB,MAAjD,CAAwDS,MAAxD;AACH;;AA9DI,CAAT","file":"body.js","sourceRoot":"../../../../../assets/js/New","sourcesContent":["const AttackType = require('Types').AttackType;\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n       person:{ //身体节点\n            default: null,\n            type: cc.Node,\n        }\n    },\n    onLoad: function () {\n       \n    },\n    update: function () {\n\n    },\n    init:function(){\n        this.animHelper = this.getComponent('animHelper');\n        this.parentCopm = this.person.getComponent('person');\n\n        //启用碰撞事件\n        cc.director.getCollisionManager().enabled = true;\n        //cc.director.getCollisionManager().enabledDebugDraw = true;\n        cc.director.getCollisionManager().enabledDrawBoundingBox = true;\n        this.node.group = this.node.parent.group;\n        cc.log(this.node.group);\n    },\n    attackOver: function () {\n        if (this.parentCopm.atkTarget == null \n            || !this.parentCopm.atkTarget.activeInHierarchy \n            || this.parentCopm.atkTarget.die == 0) {\n            return;\n        }\n        if(this.parentCopm.atkType == AttackType.Melee){\n            var damagePoint = this.parentCopm.atkPoint; //后面会加入伤害公式计算\n            this.parentCopm.atkTarget.getComponent('person').damage(damagePoint);\n        }else{\n            this.parentCopm.createFlyer();\n        }\n    },\n    moveOver: function () {\n        // cc.log('moveOver');\n    },\n\n    playAttack:function(){\n        this.animHelper.playAttack();\n    },\n\n    playMove:function(){\n        this.animHelper.playMove();\n    },\n    \n    getAnimState:function(){\n        this.animHelper.getAnimState();\n    },\n    /**\n     * 当碰撞产生的时候调用\n     * @param  {Collider} other 产生碰撞的另一个碰撞组件\n     * @param  {Collider} self  产生碰撞的自身的碰撞组件\n     */\n    onCollisionEnter: function (other, self) {\n        let demage = other.node.getComponent('flyerMove').damage;\n        this.parentCopm.atkTarget.getComponent('person').damage(demage);\n    }\n\n});"]}