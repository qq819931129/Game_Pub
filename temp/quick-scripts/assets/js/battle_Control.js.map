{"version":3,"sources":["battle_Control.js"],"names":["js_dataControl","require","GroupName","cc","Class","extends","Component","properties","canvas","Node","itemPrefab","default","type","Prefab","choosePrefab","Prefab_obstacle_01","Prefab_obstacle_02","Prefab_obstacle_03","Prefab_hero_01","Prefab_hero_02","Prefab_tempColl_touch","background","batBox","other","enemy","icon_arrow","followSpeed","onLoad","battleInit_basic","checkId","personPrefabNew","batlist","hero_list","obstacle_list","hero_route_list","state","name","list","lastId","boxIndex","hero_route_ok_list","isState","isOOOK","indexNum","getcheckId","bat","children","i","length","push","getComponent","batBoxName","bat_hero","point","groupId","console","log","perfabPool","init","battleInit_obstacle","otherList","y","x","j","bat_obstacle","battleInit_obstacle_detail","setObstacle","battleInit_hero","tempList","otherList_lock_id","otherList_lock_point","self","enemyList","id","pop","getChildByName","battleInit_hero_detail","updateHeroList","heroRouteOkList","on","EventType","TOUCH_START","event","selfItem","self_x","getLocation","self_y","heroList","route","slice","checkRoute","routeDirection","getNearEnemy","stopMove","currentBox","boxItem","temp","box_current","item","instantiate","addChild","setPosition","currentBox_destroy","child","destroy","box","itemList","createEnemy","group","empty","hero_basic","heroName","isDie","lastRouteTarget","tempColl_touch","TOUCH_MOVE","isCenter","parent","enemyList2","z","matchOKHeroRoute","TOUCH_CANCEL","touchStop","TOUCH_END","update","dt","targetBoxItem","end","v2","start","position","direction","pNormalize","pSub","pAdd","pMult","sum","pDistance","splice","repeatList","noRepeatList","ok_list","repeatIndex","repeatIndexItem","noRepeatIndex","repeat","temp_okItem","o","startTarget","endTarget","openList","closeList","sureList","isSure_start","isSure_end","minF","minG","isStart","G","H","F","directionList","setColor","color","tempEndTarget","obsExList","obsId_right","obsId_down","obsId_left","obsId_top","tempEnemyList","enemId_right","enemId_down","enemId_left","enemId_top","tempCheckTarget","checkTarget","isOpen","isClose","isObstacle","isObsEx","isEnemy","isEnemy2","H_x","Math","abs","H_y","label_G","addComponent","Label","fontSize","string","reverse","tempSureList","target","dataList"],"mappings":"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","file":"battle_Control.js","sourceRoot":"..\\..\\..\\..\\assets\\js","sourcesContent":["﻿//导入外部脚本\r\nvar js_dataControl = require(\"dataControl\");\r\nconst GroupName = require('Types').GroupName;\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        canvas: cc.Node,\r\n        itemPrefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        choosePrefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        Prefab_obstacle_01: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        Prefab_obstacle_02: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        Prefab_obstacle_03: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        Prefab_hero_01: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        Prefab_hero_02: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        Prefab_tempColl_touch: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        background: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        batBox: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        other: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        enemy: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        icon_arrow: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        followSpeed: 1\r\n    },\r\n    onLoad: function () {\r\n    \t\r\n    \t\r\n    },\r\n    //生成第一层战场数组-基础数据  (关卡id，预存资源对象)\r\n    battleInit_basic: function(checkId,personPrefabNew) {\r\n\t\t//初始化部分数组\r\n    \tthis.batlist = [];//-----------------------------战场基础层\r\n    \tthis.hero_list = [];//---------------------------战场英雄存储\r\n    \tthis.obstacle_list = [];//-----------------------战场障碍物存储\r\n    \tthis.hero_route_list = [];//---------------------英雄路线数据\r\n    \tthis.hero_route_list.state = 0;//----------------英雄路线——是否可启用 0=不可用，1=可用\r\n    \tthis.hero_route_list.name = null;//--------------英雄生成名字\r\n    \tthis.hero_route_list.list = [];//----------------英雄路线——存储路线数组\r\n    \tthis.hero_route_list.lastId = -1;//--------------英雄路线——记录上一次格子的名字  -1:初始     加入临时数组时进行赋值\r\n    \tthis.hero_route_list.boxIndex = -1;//------------英雄路线——记录格子下标   -1:初始   \r\n    \t\r\n    \tthis.hero_route_ok_list = [];//---------------------中心点英雄路线数据\r\n    \tthis.hero_route_ok_list.state = 0;//----------------中心点英雄路线——是否可启用 0=不可用，1=可用\r\n    \tthis.hero_route_ok_list.name = null;//--------------中心点英雄生成名字\r\n    \tthis.hero_route_ok_list.list = [];//----------------中心点英雄路线——存储路线数组\r\n    \tthis.hero_route_ok_list.lastId = -1;//--------------中心点英雄路线——记录上一次格子的名字  -1:初始     加入确认数组时进行赋值\r\n    \t\r\n    \tthis.isState = 0;\r\n    \tthis.isOOOK = 1;\r\n    \tthis.indexNum = 0;\r\n    \t\r\n    \tthis.checkId = js_dataControl.getcheckId();//-------获取关卡id\r\n\t\tvar bat = this.batBox.children;\r\n\t\tfor (let i = 0; i < bat.length; i++) {\r\n\t\t\tthis.batlist.push(bat[i].getComponent(\"batBox_basic\"));\r\n\t\t\tthis.batlist[i].batBoxName = bat[i].name;\r\n\t\t\tthis.batlist[i].bat_hero = {point:null,groupId:null};\r\n\t\t}\r\n\t\tconsole.log(this.batlist);\r\n        this.perfabPool = this.getComponent(\"prefabPool\");\r\n        this.perfabPool.init();\r\n\t\tthis.battleInit_obstacle(this.checkId,personPrefabNew);\r\n    },\r\n    //生成第二层战场数组-障碍物   (关卡id)\r\n    battleInit_obstacle: function(checkId,personPrefabNew){\r\n    \t//关卡序列\r\n    \tif (checkId == 1) {\r\n    \t\tvar otherList = [{y: 0,x: 4,point: 1},{y: 2,x: 4,point: 2},{y: 1,x: 4,point: 3},{y: 1,x: 6,point: 1},{y: 2,x: 7,point: 1}];\r\n    \t}\r\n    \tif (checkId == 2) {\r\n    \t\tvar otherList = [{y: 0,x: 4,point: 1},{y: 2,x: 4,point: 2},{y: 1,x: 4,point: 3}];\r\n    \t}\r\n    \tfor (let i = 0; i < otherList.length; i++) {//-----匹配战场数组\r\n    \t\tfor (let j = 0; j < this.batlist.length; j++) {//--------战场需要遍历50次，所以用batlist，而不用专门获取的batBox.getChildByName\r\n\t        \tif (this.batlist[j].x == otherList[i].x && this.batlist[j].y == otherList[i].y) {\r\n\t        \t\tthis.batlist[j].bat_obstacle = otherList[i].point;\r\n\t        \t\tthis.battleInit_obstacle_detail(otherList[i].point,this.batlist[j]);\r\n\t        \t}\r\n    \t\t}\r\n    \t}\r\n    \tconsole.log(this.obstacle_list);\r\n    \tjs_dataControl.setObstacle(this.obstacle_list);\r\n    \tthis.battleInit_hero(this.checkId,personPrefabNew);\r\n    },\r\n    //生成第三层战场数组-英雄   (关卡id)\r\n    battleInit_hero: function(checkId,personPrefabNew){\r\n    \tlet tempList = [{y: 4,x: 2,point: 6},{y: 3,x: 2,point: 7},{y: 2,x: 2,point: 8},{y: 1,x: 2,point: 9},{y: 0,x: 2,point: 10},{y: 4,x: 1,point: 11}];//----我方阵容-测试用的\r\n\t\t//let tempList = [{y: 4,x: 2,point: 6}];\r\n\t\tlet otherList = [];//-----------------------我方阵容\r\n    \tlet otherList_lock_id = 0;//----------------我方阵容——位置是否有重复英雄导入标识  0:是，1:不是\r\n    \tlet otherList_lock_point = 0;//-------------我方阵容——不同年龄系列英雄是否重复导入标识  0:是，1:不是\r\n    \tvar self = this;\r\n    \t//let fulinList = [{id: \"01\",point: 1},{id: \"02\",point: 2},{id: \"03\",point: 3}];//------符灵技能栏\r\n    \tif (checkId == 1) {\r\n\t\t\t//var enemyList = [{y: 4,x: 9,point: 1},{y: 2,x: 9,point: 2},{y: 0,x: 9,point: 3},{y: 3,x: 7,point: 4},{y: 1,x: 7,point: 5}];//----敌方阵容\r\n\t\t\tvar enemyList = [{y: 3,x: 8,point: 1}];\r\n    \t}\r\n    \tif (checkId == 2) {\r\n    \t\tvar enemyList = [{y: 3,x: 9,point: 1},{y: 1,x: 9,point: 2},{y: 0,x: 9,point: 3},{y: 0,x: 7,point: 4},{y: 1,x: 7,point: 5}];//----敌方阵容\r\n    \t}\r\n    \tfor (let i = 0; i < tempList.length; i++) {\r\n    \t\t//我方阵容区域内\r\n    \t\tif (tempList[i].id == \"00\" || tempList[i].id == \"10\" || tempList[i].id == \"20\" || tempList[i].id == \"30\" || tempList[i].id == \"40\"\r\n    \t\t || tempList[i].id == \"01\" || tempList[i].id == \"11\" || tempList[i].id == \"21\" || tempList[i].id == \"31\" || tempList[i].id == \"41\"\r\n    \t\t || tempList[i].id == \"02\" || tempList[i].id == \"12\" || tempList[i].id == \"22\" || tempList[i].id == \"32\" || tempList[i].id == \"42\") {\r\n    \t\t \tif (otherList.length < 5) {//----------------------------不超出5个英雄选择\r\n    \t\t\t\tfor (let j = 0; j < otherList.length; j++) {\r\n\t    \t\t \t\tif (otherList[j].x == tempList[i].x && otherList[j].y == tempList[i].y) {//-------发现已有英雄的位置上再放英雄，标识此次操作不加入阵容数组\r\n\t    \t\t \t\t\totherList_lock_id = 1;\r\n\t    \t\t \t\t}\r\n\t    \t\t \t\tif (otherList[j].point == tempList[i].point) {//---------发现放了不同年龄系列英雄，一个英雄分不同年龄阶段的卡牌\r\n    \t\t \t\t\t\totherList_lock_point = 1;\r\n    \t\t \t\t\t}\r\n\t\t    \t\t}\r\n\t    \t\t}\r\n    \t\t}\r\n    \t\tif (otherList.length < 5) {//----------------------------不超出5个英雄选择\r\n\t    \t\tif (otherList_lock_id == 0 && otherList_lock_point == 0) {//------标识们一致允许加入才能增加\r\n\t    \t\t\totherList.push(tempList[i]);\r\n\t    \t\t}\r\n\t    \t\tif (otherList_lock_id == 1 || otherList_lock_point == 1) {//------标识们一致允许加入才能增加\r\n\t    \t\t\totherList.pop();\r\n\t    \t\t\totherList.push(tempList[i]);\r\n\t    \t\t}\r\n    \t\t}\r\n    \t\t//初始化临时用的标识值\r\n    \t\totherList_lock_id = 0;\r\n    \t\totherList_lock_point = 0;\r\n\t\t}\r\n\t\t\r\n    \tfor (let i = 0; i < otherList.length; i++) {//-----我方英雄导入战场\r\n    \t\tfor (let j = 0; j < this.batlist.length; j++) {//--------战场需要遍历50次，所以用batlist，而不用专门获取的batBox.getChildByName\r\n\t        \tif (this.batlist[j].x == otherList[i].x && this.batlist[j].y == otherList[i].y) {\r\n\t        \t\tthis.batlist[j].bat_hero = {\r\n\t        \t\t\tpoint: otherList[i].point,\r\n\t        \t\t\tgroupId: 1\r\n\t        \t\t}\r\n\t        \t\tthis.batBox.getChildByName(\"batBox_y\" + this.batlist[j].y + \"_x\" + this.batlist[j].x).bat_hero = this.batlist[j].bat_hero;\r\n\t        \t\tthis.battleInit_hero_detail(otherList[i].point,this.batlist[j],1,personPrefabNew);\r\n\t        \t}\r\n    \t\t}\r\n    \t}\r\n    \tfor (let i = 0; i < enemyList.length; i++) {//-----敌方英雄导入战场\r\n    \t\tfor (let j = 0; j < this.batlist.length; j++) {//--------战场需要遍历50次，所以用batlist，而不用专门获取的batBox.getChildByName\r\n\t        \tif (this.batlist[j].x == enemyList[i].x && this.batlist[j].y == enemyList[i].y) {\r\n\t        \t\tthis.batlist[j].bat_hero = {\r\n\t        \t\t\tpoint: enemyList[i].point,\r\n\t        \t\t\tgroupId: 2\r\n\t        \t\t}\r\n\t        \t\tthis.batBox.getChildByName(\"batBox_y\" + this.batlist[j].y + \"_x\" + this.batlist[j].x).bat_hero = this.batlist[j].bat_hero;\r\n\t        \t\tthis.battleInit_hero_detail(enemyList[i].point,this.batlist[j],2,personPrefabNew);\r\n\t        \t}\r\n    \t\t}\r\n    \t}\r\n    \tconsole.log(this.batlist);\r\n    \t\r\n    \tjs_dataControl.updateHeroList(this.hero_list);\r\n\t\tvar heroRouteOkList = this.hero_route_ok_list;\r\n    \tthis.background.getChildByName(\"stopAllMove\").on(cc.Node.EventType.TOUCH_START, function ( event ) {\r\n\t\t\tlet selfItem = this;\r\n\t\t\tlet self_x = event.getLocation().x;\r\n\t\t\tlet self_y = event.getLocation().y;\r\n\t\t\tlet heroList = self.hero_list;\r\n\t\t\tfor (let j = 0; j < heroList.length; j++) {//---------匹配英雄表\r\n\t\t\t\theroList[j].route = heroList[j].route.slice(0,heroList[j].indexNum+1);\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.background.getChildByName(\"goAllMove\").on(cc.Node.EventType.TOUCH_START, function ( event ) {\r\n\t\t\tlet selfItem = this;\r\n\t\t\tlet self_x = event.getLocation().x;\r\n\t\t\tlet self_y = event.getLocation().y;\r\n\t\t\tlet heroList = self.hero_list;\r\n\t\t\tfor (let j = 0; j < heroList.length; j++) {//---------匹配英雄表\r\n\t\t\t\tif (heroList[j].groupId == 1) {\r\n\t\t\t\t//if (heroList[j].heroName == \"hero_6\") {\r\n\t\t\t\t\tlet checkRoute = self.routeDirection(heroList[j],self.getNearEnemy(heroList[j],heroList));\r\n\t\t\t\t\theroList[j].route = checkRoute;\r\n\t\t\t\t\theroList[j].state = 11;\r\n\t\t\t\t\theroList[j].indexNum = 0;\r\n\t\t\t\t\t//self.matchOKHeroRoute(heroList[j].name,self.getNearEnemy(heroList[j],heroList));//-------传参英雄名和格子对象给确认数组\r\n\t\t\t\t\tconsole.log(heroList[j],checkRoute,self.getNearEnemy(heroList[j],heroList));\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t});\r\n    },\r\n    stopMove:function (point) {\r\n    \tvar self = this;\r\n    \tlet heroList = self.hero_list;\r\n\t\tfor (let j = 0; j < heroList.length; j++) {//---------匹配英雄表\r\n\t\t\tif (heroList[j].point == point) {\r\n\t\t\t//if (heroList[j].heroName == \"hero_6\") {\r\n\t\t\t\tlet checkRoute = self.routeDirection(heroList[j],self.getNearEnemy(heroList[j],heroList));\r\n\t\t\t\theroList[j].route = checkRoute;\r\n\t\t\t\theroList[j].state = 11;\r\n\t\t\t\theroList[j].indexNum = 0;\r\n\t\t\t\t//lf.matchOKHeroRoute(heroList[j].name,self.getNearEnemy(heroList[j],heroList));//-------传参英雄名和格子对象给确认数组\r\n\t\t\t\t//console.log(heroList[j],checkRoute,self.getNearEnemy(heroList[j],heroList));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n    },\r\n    //选取格子高亮   (格子对象)\r\n    currentBox: function(boxItem){\r\n    \tvar temp = this.batBox.getChildByName(\"batBox_y\" + boxItem.y + \"_x\" + boxItem.x);\r\n    \t//console.log(temp.getComponent(\"batBox_basic\").box_current,temp.getComponent(\"batBox_basic\"));\r\n    \tif(temp.getComponent(\"batBox_basic\").box_current == 0){//------------------------------防止重复加载同一个格子高亮导致出现异常bug情况\r\n\t\t\ttemp.getComponent(\"batBox_basic\").box_current = 1;//-------------------------------高亮选择到的格子\r\n\t    \tlet item = cc.instantiate(this.icon_arrow); \r\n\t\t\ttemp.addChild(item);\r\n\t\t\titem.setPosition(boxItem.x,boxItem.y);\r\n\t    \titem.name = \"currentBox\";\r\n    \t}\r\n    },\r\n    //销毁高亮资源   (格子对象)\r\n    currentBox_destroy: function(boxItem){\r\n\t\tthis.batBox.getChildByName(\"batBox_y\" + boxItem.y + \"_x\" + boxItem.x).getComponent(\"batBox_basic\").box_current = 0;//----------------------清除高亮记录\r\n\t\tlet child = this.batBox.getChildByName(\"batBox_y\" + boxItem.y + \"_x\" + boxItem.x).getChildByName(\"currentBox\");\r\n\t\tif (child) { child.destroy(); }//--------------------------------------------------------------销毁高亮资源\r\n    },\r\n    //障碍物具体参数数组   (障碍物编号，格子对象)\r\n    battleInit_obstacle_detail: function(point,box){\r\n    \tif (point == 1) { var item = cc.instantiate(this.Prefab_obstacle_01); }\r\n    \tif (point == 2) { var item = cc.instantiate(this.Prefab_obstacle_02); }\r\n    \tif (point == 3) { var item = cc.instantiate(this.Prefab_obstacle_03); }\r\n    \tthis.batBox.getChildByName(\"batBox_y\" + box.y + \"_x\" + box.x).addChild(item);\r\n    \titem.setPosition(0,0);\r\n    \titem.name = \"point_\" + point;\r\n    \tvar itemList = {\r\n    \t\tx\t\t: box.x,\t\t\t\t//障碍物当前所处x轴\r\n    \t\ty\t\t: box.y,\t\t\t\t//障碍物当前所处y轴\r\n    \t}\r\n    \tthis.obstacle_list.push(itemList);\r\n    \t\r\n    },\r\n    //英雄具体参数数组   (英雄编号，格子对象，敌我英雄标识id: 1=我方   2=敌方)\r\n    battleInit_hero_detail: function(point,box,groupId,personPrefabNew){\r\n    \tif (point == 1) { var item = this.perfabPool.createEnemy(); }\r\n    \tif (point == 2) { var item = this.perfabPool.createEnemy(); }\r\n    \tif (point == 3) { var item = this.perfabPool.createEnemy(); }\r\n    \tif (point == 4) { var item = this.perfabPool.createEnemy(); }\r\n    \tif (point == 5) { var item = this.perfabPool.createEnemy(); }\r\n    \tif (point == 6) { var item = this.perfabPool.createEnemy(); }\r\n    \tif (point == 7) { var item = this.perfabPool.createEnemy(); }\r\n    \tif (point == 8) { var item = this.perfabPool.createEnemy(); }\r\n    \tif (point == 9) { var item = this.perfabPool.createEnemy(); }\r\n    \tif (point == 10) { var item = this.perfabPool.createEnemy(); }\r\n\t\tif (point == 11) { var item = this.perfabPool.createEnemy(); }\r\n\t\tif(groupId == 1){\r\n\t\t\titem.getComponent('person').group = GroupName.other\r\n\t\t\tthis.other.addChild(item);\r\n\t\t}\r\n\t\tif(groupId == 2){\r\n\t\t\titem.getComponent('person').group = GroupName.empty;\r\n\t\t\tthis.enemy.addChild(item);\r\n\t\t}\r\n\t\tvar x = this.batBox.getChildByName(\"batBox_y\" + box.y + \"_x\" + box.x).x;\r\n\t\tvar y = this.batBox.getChildByName(\"batBox_y\" + box.y + \"_x\" + box.x).y;\r\n    \titem.setPosition(x,y);\r\n    \titem.name = \"hero_\" + point;\r\n    \tif(groupId == 1){\r\n\t\t\tvar hero_basic = this.other.getChildByName(item.name).getComponent(\"person\");\r\n\t    \thero_basic.groupId = groupId;\r\n\t    \thero_basic.heroName = item.name;\r\n\t    \thero_basic.x = box.x;\r\n\t    \thero_basic.y = box.y;\r\n\t    \thero_basic.point = point;\r\n    \t}\r\n    \tif(groupId == 2){\r\n\t\t\tvar hero_basic = this.enemy.getChildByName(item.name).getComponent(\"person\");\r\n\t    \thero_basic.groupId = groupId;\r\n\t    \thero_basic.heroName = item.name;\r\n\t    \thero_basic.x = box.x;\r\n\t    \thero_basic.y = box.y;\r\n\t    \thero_basic.point = point;\r\n    \t}\r\n    \tlet itemList = {\r\n    \t\tgroupId : groupId,\t\t\t\t//英雄敌我阵容标识\r\n    \t\theroName: item.name,\t\t\t//英雄预存资源生成名称\r\n    \t\tx\t\t: box.x,\t\t\t\t//英雄当前所处x轴\r\n    \t\ty\t\t: box.y,\t\t\t\t//英雄当前所处y轴\r\n    \t\tpoint\t: point,\t\t\t\t//英雄标记  纪录具体是哪个英雄\r\n    \t\tindexNum: 0,\t\t\t\t\t//英雄移动路线的当前到达位置，就是说数组里的第几个位置\r\n    \t\troute\t: [],\t\t\t\t\t//英雄移动路线   状态切换为移动时，赋值路线\r\n\t\t\tstate\t: 10,\t\t\t\t\t//英雄状态   10：待命，11：移动\r\n\t\t\tisDie   : 1\t\t\t\t\t\t//死亡标识   0：死亡，1:未死亡\r\n    \t}\r\n    \tthis.hero_list.push(itemList);\r\n    \tvar self = this;\r\n\t\tvar heroRouteOkList = this.hero_route_ok_list;\r\n\t\tvar lastRouteTarget = null;//-------------------用作碰触到障碍物后保留前一个格子对象\r\n\t\tif(groupId == 1){\r\n\t\t\tthis.other.getChildByName(\"hero_\" + point).on(cc.Node.EventType.TOUCH_START, function ( event ) {\r\n\t\t\t\tlet selfItem = this;\r\n\t\t\t\t//console.log(selfItem);\r\n\t\t\t\tlet self_x = event.getLocation().x;\r\n\t\t\t\tlet self_y = event.getLocation().y;\r\n\t\t\t\tif (self.background.getChildByName(\"tempColl_touch\")) { self.background.getChildByName(\"tempColl_touch\").destroy();}//--------销毁之前生成的临时路线碰触点 \r\n\t\t\t\t//---生成临时路线碰触点   如果不重新生成，会出现触碰点一直碰着相同格子没反应的问题，例如不断触碰起点，碰撞系统好像如果不离开碰触体，就不会重新算碰撞到\r\n\t\t\t\tlet tempColl_touch = cc.instantiate(self.Prefab_tempColl_touch);\r\n\t\t\t\tself.background.addChild(tempColl_touch);\r\n\t\t\t\ttempColl_touch.setPosition(self_x,self_y);\r\n\t\t\t\tself.background.getChildByName(\"tempColl_touch\").getComponent(\"colliderListener\").boxItem = null;//---初始化碰撞点上的格子对象\r\n\t\t    \t/*if (heroRouteOkList.list.length != 0) {\r\n\t\t\t\t\tlet heroList = self.hero_list;\r\n\t\t\t\t\tfor (let j = 0; j < heroList.length; j++) {//---------匹配英雄表\r\n\t\t\t\t\t\tif(self.hero_list[j].heroName == selfItem.name){//--------------找出赋值英雄移动数组\r\n\t\t\t\t\t\t\tself.hero_list[j].state = 10;//------------------------------------英雄状态切换为：移动\r\n\t\t\t\t\t\t\tself.hero_list[j].route = heroRouteOkList.list;//------------------赋值路线\r\n\t\t\t\t\t\t\tself.hero_list[j].indexNum = 0;//----------------------------------初始化移动路线的到达位置\r\n\t\t\t\t\t\t\theroRouteOkList.list = [];//---------------------------临时路线清空\r\n\t\t\t\t\t\t\theroRouteOkList.state = 0;//---------------------------临时路线状态改为不启用\r\n\t\t\t\t\t\t\theroRouteOkList.name = null;//-------------------------临时路线的英雄名清除\r\n\t\t\t\t\t\t\theroRouteOkList.lastId = -1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}*/\r\n\t\t\t});\r\n\t\t\tthis.other.getChildByName(\"hero_\" + point).on(cc.Node.EventType.TOUCH_MOVE, function ( event ) {\r\n\t\t\t\tlet selfItem = this;\r\n\t\t\t\tlet self_x = event.getLocation().x;\r\n\t\t\t\tlet self_y = event.getLocation().y;\r\n\t\t\t\tself.background.getChildByName(\"tempColl_touch\").x = self_x;//-------实时更改临时路线碰触点位置\r\n\t\t\t\tself.background.getChildByName(\"tempColl_touch\").y = self_y;\r\n\t\t\t\tlet isCenter = 0;\r\n\t\t\t\tvar boxItem = self.background.getChildByName(\"tempColl_touch\").getComponent(\"colliderListener\").boxItem;\r\n\t\t\t\tif (boxItem) {\r\n\t\t\t\t\tif (boxItem.name == \"batBox_Center\") {\r\n\t\t\t\t\t\tboxItem = boxItem.parent.getComponent(\"batBox_basic\");\r\n\t\t\t\t\t\tisCenter = 1;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tboxItem = boxItem.getComponent(\"batBox_basic\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar enemyList2 = [];\r\n\t    \t\t\tfor (var z = 0; z < self.hero_list.length; z++) {\r\n\t    \t\t\t\tif(self.hero_list[z].point == boxItem.bat_hero.point && self.hero_list[z].groupId == 2){\r\n\t    \t\t\t\t\tenemyList2.push(self.hero_list[z]);\r\n\t    \t\t\t\t}\r\n\t    \t\t\t}\r\n\t    \t\t\t\r\n\t\t\t\t\tif (!boxItem.bat_obstacle && enemyList2.length == 0) {\r\n\t\t\t\t\t\tif (heroRouteOkList.lastId == -1) {//--------------------------------还没记录到上一次的格子名字，证明是在获取第一次路线信息\r\n\t\t\t\t\t\t\tfor (let i = 0; i < self.hero_list.length; i++) {//------------循环英雄数组\r\n\t\t\t\t\t\t\t\tif (self.hero_list[i].heroName == selfItem.name) {//----------匹配当前点击的格子上是否存在英雄\r\n\t\t\t\t\t\t\t\t\tself.matchOKHeroRoute(selfItem.name,boxItem);//-------传参英雄名和格子对象给确认数组\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tif (isCenter == 1) {\r\n\t\t\t\t\t\t\t\tif(heroRouteOkList.lastId != boxItem.batBoxName){//----------当前触碰的格子不是上一次记录的格子（此判断为了防止不断触碰相同格子一直执行以下方法）\r\n\t\t\t\t\t\t\t\t\tself.matchOKHeroRoute(heroRouteOkList.name,boxItem);//-------传参英雄名和格子对象给确认数组\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tthis.other.getChildByName(\"hero_\" + point).on(cc.Node.EventType.TOUCH_CANCEL, function ( event ) {\r\n\t\t\t\tlet self_x = event.getLocation().x;\r\n\t\t\t\tlet self_y = event.getLocation().y;\r\n\t\t\t\t//console.log(heroRouteOkList.list,heroRouteOkList.name);\r\n\t\t\t\tvar boxItem = self.background.getChildByName(\"tempColl_touch\").getComponent(\"colliderListener\").boxItem;\r\n\t\t\t\tif (boxItem.name == \"batBox_Center\") {\r\n\t\t\t\t\tboxItem = boxItem.parent.getComponent(\"batBox_basic\");\r\n\t\t\t\t}else{\r\n\t\t\t\t\tboxItem = boxItem.getComponent(\"batBox_basic\");\r\n\t\t\t\t}\r\n\t\t\t\tself.matchOKHeroRoute(heroRouteOkList.name,boxItem);//-------传参英雄名和格子对象给确认数组，有时越墙后也能填补后续路线\r\n\t\t\t\tself.touchStop();\r\n\t\t\t});\r\n\t\t\tthis.other.getChildByName(\"hero_\" + point).on(cc.Node.EventType.TOUCH_END, function ( event ) {\r\n\t\t\t\tlet self_x = event.getLocation().x;\r\n\t\t\t\tlet self_y = event.getLocation().y;\r\n\t\t\t\tvar boxItem = self.background.getChildByName(\"tempColl_touch\").getComponent(\"colliderListener\").boxItem;\r\n\t\t\t\tif (boxItem.name == \"batBox_Center\") {\r\n\t\t\t\t\tboxItem = boxItem.parent.getComponent(\"batBox_basic\");\r\n\t\t\t\t}else{\r\n\t\t\t\t\tboxItem = boxItem.getComponent(\"batBox_basic\");\r\n\t\t\t\t}\r\n\t\t\t\tself.matchOKHeroRoute(heroRouteOkList.name,boxItem);//-------传参英雄名和格子对象给确认数组，有时越墙后也能填补后续路线\r\n\t\t\t\tself.touchStop();\r\n\t\t\t});\r\n\t\t}\r\n    },\r\n    update: function (dt) {\r\n    \tlet self = this;\r\n\t\tlet heroList = self.hero_list;\r\n\t\tfor (let j = 0; j < heroList.length; j++) {//---------匹配英雄表\r\n\t\t\tif(heroList[j].state == 11){//--------------找出赋值英雄移动数组\r\n\t\t\t\tlet targetBoxItem = self.batBox.getChildByName(\"batBox_y\" + heroList[j].route[heroList[j].indexNum].y + \"_x\" + heroList[j].route[heroList[j].indexNum].x);\r\n\t\t\t\tlet end = cc.v2(targetBoxItem.x,targetBoxItem.y);//------------------------获取下个目标xy\r\n\t\t\t\tlet start = self.other.getChildByName(heroList[j].heroName).position;//-------------获取目标当前xy\r\n\t\t\t\tlet direction = cc.pNormalize(cc.pSub(end, start));//------------------------先获取俩个向量的差，然后返回一个长度为1的标准化后的向量\r\n\t\t\t\tlet item = cc.pAdd(start, cc.pMult(direction, self.followSpeed ));//----缩放上面的标准化向量，然后把初始目标xy加上缩放的向量\r\n\t\t\t\tself.other.getChildByName(heroList[j].heroName).setPosition(item);//----------------更新目标位置\r\n\t\t\t\tlet sum = cc.pDistance(start, end);\r\n\t\t\t\tif (sum <= 1 && heroList[j].indexNum < heroList[j].route.length) {//-----------------向量测出英雄和下一个格子中心在1范围内就进入下一个路线\r\n\t\t\t\t\theroList[j].x = targetBoxItem.getComponent(\"batBox_basic\").x;//----------------------------------------英雄当前x轴修改\r\n\t\t\t\t\theroList[j].y = targetBoxItem.getComponent(\"batBox_basic\").y;//----------------------------------------英雄当前y轴修改\r\n\t\t\t\t\tjs_dataControl.updateHeroList(heroList);//----------------更新存储数据层js的英雄详细数组\r\n\t\t\t\t\tif (heroList[j].route[heroList[j].indexNum-1]) {//清除当前移动对象上一步格子里的标识\r\n\t\t\t\t\t\tself.batBox.getChildByName(\"batBox_y\" + heroList[j].route[heroList[j].indexNum-1].y + \"_x\" + heroList[j].route[heroList[j].indexNum-1].x).bat_hero.point = \"\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconsole.log(self.batBox.getChildByName(\"batBox_y\" + heroList[j].route[heroList[j].indexNum].y + \"_x\" + heroList[j].route[heroList[j].indexNum].x));\r\n\t\t\t\t\t\r\n\t\t\t\t\tself.batBox.getChildByName(\"batBox_y\" + heroList[j].route[heroList[j].indexNum].y + \"_x\" + heroList[j].route[heroList[j].indexNum].x).bat_hero.point = heroList[j].point;//------更改第一层战场格子上的英雄标记\r\n\t\t\t\t\t//英雄路线移动完毕后执行以下方法\r\n\t\t\t\t\tif ((heroList[j].indexNum+1) == heroList[j].route.length) {\r\n\t\t\t\t\t\theroList[j].state = 10;\r\n\t\t\t\t\t\tconsole.log(self.batBox);\r\n\t\t\t\t\t}\r\n\t\t\t\t\theroList[j].indexNum++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n    },\r\n    //鼠标或手指碰触结束   (路线确认数组)\r\n    touchStop: function(){\r\n    \tvar self = this;\r\n\t\tvar heroRouteOkList = this.hero_route_ok_list;\r\n\t\tfor (let z = 0; z < heroRouteOkList.list.length; z++) {\r\n\t\t\tself.currentBox_destroy(heroRouteOkList.list[z]);//--------------------------销毁高亮资源方法\r\n\t\t}\r\n    \tif (heroRouteOkList.list.length != 0) {\r\n\t\t\tlet heroList = self.hero_list.length;\r\n\t\t\tfor (let j = 0; j < heroList; j++) {//---------匹配英雄表\r\n\t\t\t\tif(self.hero_list[j].heroName == heroRouteOkList.name){//--------------找出赋值英雄移动数组\r\n\t\t\t\t\tself.hero_list[j].state = 11;//------------------------------------英雄状态切换为：移动\r\n\t\t\t\t\tself.hero_list[j].route = heroRouteOkList.list;//------------------赋值路线\r\n\t\t\t\t\tself.hero_list[j].indexNum = 0;//----------------------------------初始化移动路线的到达位置\r\n\t\t\t\t\theroRouteOkList.list = [];//---------------------------临时路线清空\r\n\t\t\t\t\theroRouteOkList.state = 0;//---------------------------临时路线状态改为不启用\r\n\t\t\t\t\theroRouteOkList.name = null;//-------------------------临时路线的英雄名清除\r\n\t\t\t\t\theroRouteOkList.lastId = -1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n    },\r\n    //检测触碰到的英雄-确认   (英雄名,格子对象)\r\n    matchOKHeroRoute: function(heroName,boxItem){\r\n    \tlet heroRouteOkList = this.hero_route_ok_list;\r\n\t\theroRouteOkList.state = 1;//----------------------------------临时路线记录数组启用\r\n\t\theroRouteOkList.name = heroName;//----------------------------临时路线数组，记录英雄标识\r\n\t\theroRouteOkList.lastId = boxItem.batBoxName;//----------------赋值当前格子的名字\r\n\t\tif (heroRouteOkList.list.length == 0) {//-----------------------------已选格子不再执行以下方法\r\n    \t\tlet item = {\r\n    \t\t\tx\t: boxItem.x,\r\n    \t\t\ty\t: boxItem.y\r\n    \t\t}\r\n    \t\theroRouteOkList.list.push(item);\r\n\t\t\tthis.currentBox(boxItem);\r\n\t\t}else{\r\n\t\t\tlet z = -1;//--------------获取确认数组的最后一个格子id\r\n\t\t\t//---获取A*填充数组，条件是当前确认数组最后一个格子对象和最新所选到的格子对象，用作处理可能越几格的路线填充\r\n\t\t\tlet checkRoute = this.routeDirection(heroRouteOkList.list[heroRouteOkList.list.length-1],boxItem);\r\n\t\t\tconsole.log(checkRoute,heroRouteOkList.list);\r\n\t\t\tif (checkRoute) { checkRoute.splice(0,1); }//-----------清空A*返回的路线数组的第一个格子路线，因为会和旧路线最后一个格子重复了\r\n\t\t\tlet repeatList = [];//-----------------存储A*填充数组里和当前确认数组重复的格子对象，用作出现路线重复回滚\r\n\t\t\tlet noRepeatList = [];//---------------存储A*填充数组里不和当前确认数组不重复的格子对象，用作出现路线重复回滚时，可以继续填充路线\r\n\t\t\tlet ok_list = [];//--------------------临时存储确认数组的list\r\n\t\t\tlet repeatIndex = -1;//----------------记录A*填充数组最后一个格子下标   -1:初始   \r\n\t\t\tlet repeatIndexItem = null;//----------记录A*填充数组最后一个格子对象   -1:初始   \r\n\t\t\tlet noRepeatIndex = -1;//--------------记录回滚点是否触发的标识   1:是，2:否  \r\n\t\t\tfor (let i = 0; i < checkRoute.length; i++) {\r\n\t\t\t\tfor (let j = 0; j < heroRouteOkList.list.length; j++) {\r\n\t\t\t\t\tif (heroRouteOkList.list[j].x == checkRoute[i].x && heroRouteOkList.list[j].y == checkRoute[i].y) {\r\n\t\t\t\t\t\trepeatList.push(checkRoute[i]);\r\n\t\t\t\t\t\tcheckRoute[i].repeat = 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\theroRouteOkList.list.push(checkRoute[i]);\r\n\t\t\t\tthis.currentBox(this.batBox.getChildByName(\"batBox_y\" + checkRoute[i].y + \"_x\" + checkRoute[i].x).getComponent(\"batBox_basic\"));\r\n\t\t\t}\r\n\t\t\tconsole.log(repeatList,heroRouteOkList.list);\r\n\t\t\tif (repeatList.length > 0) {//-----------A*填充数组存在2个值时代表越墙或者终点不只在起点九宫格\r\n\t\t\t\tfor (let x = 0; x < heroRouteOkList.list.length; x++) {\r\n\t\t\t\t\tif (repeatIndex == -1) {//-----------------标识不存在时\r\n\t\t\t\t\t\tif (repeatList[repeatList.length-1].x == heroRouteOkList.list[x].x && repeatList[repeatList.length-1].y == heroRouteOkList.list[x].y) {//------当前格子id等于确认数组id时\r\n\t\t\t\t\t\t\trepeatIndex = x;//-----------------赋值标识为当前循环下标\r\n\t\t\t\t\t\t\trepeatIndexItem = this.batBox.getChildByName(\"batBox_y\" + heroRouteOkList.list[x].y + \"_x\" + heroRouteOkList.list[x].x).getComponent(\"batBox_basic\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tlet temp_okItem = this.batBox.getChildByName(\"batBox_y\" + heroRouteOkList.list[x].y + \"_x\" + heroRouteOkList.list[x].x).getComponent(\"batBox_basic\").batBoxName;\r\n\t\t\t\t\t\tconsole.log(repeatIndexItem.batBoxName , temp_okItem);\r\n\t\t\t\t\t\tif (repeatIndexItem.batBoxName != temp_okItem && noRepeatIndex == -1) {//还没检测到出现回滚点，就一直销毁前面的高亮路线\r\n\t\t\t\t\t\t\tthis.currentBox_destroy(heroRouteOkList.list[x]);//--------------------------销毁高亮资源方法\r\n\t\t\t\t\t\t}else{//-----------------------------------------------------------------检测到出现回滚点，停止销毁高亮路线，保留后续循环的路线，因为那些基本上是回滚后的新路线\r\n\t\t\t\t\t\t\tnoRepeatIndex = 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tfor (let o = 0; o < repeatIndex +1; o++) {//---循环不重复的下标+1的次数来获取确认数组路线\r\n\t\t\t\t\tlet item = {\r\n\t\t\t\t\t\tx\t: heroRouteOkList.list[o].x,\r\n\t\t\t\t\t\ty\t: heroRouteOkList.list[o].y\r\n\t\t\t\t\t}\r\n\t\t\t\t\tok_list.push(item);\r\n\t\t\t\t}\r\n\t\t\t\theroRouteOkList.list = ok_list;\r\n\t\t\t\tconsole.log(repeatIndex,heroRouteOkList.list);\r\n\t\t\t\tconsole.log(noRepeatList,repeatList);\r\n\t\t\t}\r\n\t\t}\r\n\t\t//console.log(heroRouteOkList.list);\r\n    },\r\n    //A*算法   (原点目标，终点目标)\r\n    routeDirection: function(startTarget,endTarget){\r\n    \tif (startTarget.x == endTarget.x && startTarget.y == endTarget.y || endTarget.bat_obstacle) { return false; }//---------------如果起点和终点一样就退出方法\r\n    \tlet openList = [];//---------------九宫格临时存放格子数组\r\n    \tlet closeList = [];//--------------九宫格临时存放确认数组\r\n    \tlet sureList = [];//---------------九宫格最终确认数组\r\n    \tlet isSure_start = 0;//------------是否到达终点   0：不是   1：是\r\n    \tlet isSure_end = 0;//--------------是否到达起点   0：不是   1：是\r\n    \tlet minF = 0;//--------------------F值最小值\r\n    \tlet minG = 0;//--------------------G值最小值\r\n    \tlet parent = {x: startTarget.x, y: startTarget.y, isStart: 1, G: 0, H:0, F:0};//-----------isStart: 起点的唯一标识\r\n    \topenList.push(parent);\r\n\t\t//方向数组  也可用作判断格子九宫格里其余格子是否在战场内数组   id：判断方向的数值   direction：上下左右斜方向值\r\n\t\tlet directionList = [{y:0,x:1,direction:1},{y:-1,x:1,direction:2},{y:-1,x:0,direction:3},{y:-1,x:-1,direction:4},{y:0,x:-1,direction:5},{y:1,x:-1,direction:6},{y:1,x:0,direction:7},{y:1,x:1,direction:8}];\r\n\t\tthis.batBox.getChildByName(\"batBox_y\" + startTarget.y + \"_x\" + startTarget.x).setColor(cc.color(\"#008102\"));//-----测试阶段，上颜色标识用\r\n\t\tthis.batBox.getChildByName(\"batBox_y\" + endTarget.y + \"_x\" + endTarget.x).setColor(cc.color(\"#fff\"));//-----测试阶段，上颜色标识用\r\n\t\tvar tempEndTarget = this.batBox.getChildByName(\"batBox_y\" + endTarget.y + \"_x\" + endTarget.x).getComponent(\"batBox_basic\");\r\n\t\tfor (let j = 0; j < openList.length; j++) {\r\n\t\t\tif (isSure_start == 1) { break; }//----------已到达终点，退出循环\r\n\t\t\t//console.log(j+\"——————————————————————————————————————————————————\");\r\n\t\t\t//console.log(parent,openList[j]);\r\n\t\t\tlet obsExList = [];//--------------障碍物上下左右格子的数组\r\n    \t\tlet obsId_right = null;//----------当前障碍物格子的右侧格子--临时禁止加入临时数组\r\n    \t\tlet obsId_down = null;//-----------当前障碍物格子的下侧格子--临时禁止加入临时数组\r\n    \t\tlet obsId_left = null;//-----------当前障碍物格子的左侧格子--临时禁止加入临时数组\r\n    \t\tlet obsId_top = null;//------------当前障碍物格子的上侧格子--临时禁止加入临时数组\r\n\t    \tvar tempEnemyList = [];\r\n    \t\tlet enemId_right = null;//----------当前敌人格子的右侧格子--临时禁止加入临时数组\r\n    \t\tlet enemId_down = null;//-----------当前敌人格子的下侧格子--临时禁止加入临时数组\r\n    \t\tlet enemId_left = null;//-----------当前敌人格子的左侧格子--临时禁止加入临时数组\r\n    \t\tlet enemId_top = null;//------------当前敌人格子的上侧格子--临时禁止加入临时数组\r\n\t\t\tfor (let i = 0; i < directionList.length; i++) {//------------------获取路线障碍物上下左右格子的数组\r\n\t\t\t\t//计算出九宫格内当前循环的格子是否在战场内  原理：利用格子的行列值进行运算，得出结果异常则不属于战场内格子\r\n\t    \t\tlet tempCheckTarget = this.batBox.getChildByName(\"batBox_y\" + (parent.y + directionList[i].y) + \"_x\" + (parent.x + directionList[i].x));\r\n\t\t\t\tif (tempCheckTarget) {//----------是否存在格子\r\n\t\t\t\t\tvar checkTarget = tempCheckTarget.getComponent(\"batBox_basic\");\r\n\t    \t\t\tif (checkTarget.bat_obstacle) {//---------------------当前循环九宫格格子是障碍物\r\n\t    \t\t\t\tif (i == 0 || i == 2 || i == 4 || i == 6) {\r\n\t    \t\t\t\t\tobsId_right = {y:(checkTarget.y + directionList[0].y),x:(checkTarget.x + directionList[0].x)};\r\n\t    \t\t\t\t\tobsId_down = {y:(checkTarget.y + directionList[2].y),x:(checkTarget.x + directionList[2].x)};\r\n\t    \t\t\t\t\tobsId_left = {y:(checkTarget.y + directionList[4].y),x:(checkTarget.x + directionList[4].x)};\r\n\t    \t\t\t\t\tobsId_top = {y:(checkTarget.y + directionList[6].y),x:(checkTarget.x + directionList[6].x)};\r\n\t    \t\t\t\t\tobsExList.push(obsId_right,obsId_down,obsId_left,obsId_top);\r\n\t    \t\t\t\t}\r\n\t    \t\t\t}\r\n\t    \t\t\tvar enemyList2 = [];\r\n\t    \t\t\tfor (var z = 0; z < this.hero_list.length; z++) {\r\n\t    \t\t\t\tif(this.hero_list[z].point == checkTarget.bat_hero.point && this.hero_list[z].groupId == 2){\r\n\t    \t\t\t\t\tenemyList2.push(this.hero_list[z]);\r\n\t    \t\t\t\t}\r\n\t    \t\t\t}\r\n\t    \t\t\tif (enemyList2) {\r\n\t    \t\t\t\tif (i == 0 || i == 2 || i == 4 || i == 6) {\r\n\t    \t\t\t\t\tenemId_right = {y:(checkTarget.y + directionList[0].y),x:(checkTarget.x + directionList[0].x)};\r\n\t    \t\t\t\t\tenemId_down = {y:(checkTarget.y + directionList[2].y),x:(checkTarget.x + directionList[2].x)};\r\n\t    \t\t\t\t\tenemId_left = {y:(checkTarget.y + directionList[4].y),x:(checkTarget.x + directionList[4].x)};\r\n\t    \t\t\t\t\tenemId_top = {y:(checkTarget.y + directionList[6].y),x:(checkTarget.x + directionList[6].x)};\r\n\t    \t\t\t\t\ttempEnemyList.push(enemId_right,enemId_down,enemId_left,enemId_top);\r\n\t    \t\t\t\t}\r\n\t    \t\t\t}\r\n\t    \t\t}\r\n\t\t\t}\r\n\t    \tfor (let i = 0; i < directionList.length; i++) {//------------------获取路线临时数组\r\n\t    \t\tlet isOpen = 0;//------------------是否已记录在临时数组标识   0：不是   1：是\r\n\t    \t\tlet isClose = 0;//-----------------是否已记录在确认数组标识   0：不是   1：是\r\n\t    \t\tlet isObstacle = 0;//--------------是否障碍物   0：不是   1：是\r\n\t    \t\tlet isObsEx = 0;//-----------------当前格子是否位于障碍物格子上下左右侧的格子位置上，用于判断是否处于斜格处理   0：不是   1：是\r\n\t    \t\tvar isEnemy = false;\r\n\t    \t\tvar isEnemy2 = 0;\r\n\t    \t\t//计算出九宫格内当前循环的格子  原理：利用格子的行列值进行运算，得出结果异常则不属于战场内格子\r\n\t    \t\tlet tempCheckTarget = this.batBox.getChildByName(\"batBox_y\" + (parent.y + directionList[i].y) + \"_x\" + (parent.x + directionList[i].x));\r\n\t    \t\tif (tempCheckTarget) {//----------是否存在格子\r\n\t\t\t\t\tvar checkTarget = tempCheckTarget.getComponent(\"batBox_basic\");\r\n\t\t\t\t\tvar enemyList2 = [];\r\n\t    \t\t\tfor (var z = 0; z < this.hero_list.length; z++) {\r\n\t    \t\t\t\tif(this.hero_list[z].point == checkTarget.bat_hero.point && this.hero_list[z].groupId == 2){\r\n\t    \t\t\t\t\tenemyList2.push(this.hero_list[z]);\r\n\t    \t\t\t\t}\r\n\t    \t\t\t}\r\n\t    \t\t\tif (checkTarget.bat_obstacle) {//---------------------当前循环九宫格格子是障碍物\r\n\t    \t\t\t\tisObstacle = 1;\r\n\t    \t\t\t}else if(enemyList2.length != 0){\r\n\t    \t\t\t\tisEnemy = true;\r\n\t    \t\t\t}else{\r\n\t\t    \t\t\tfor (let x = 0; x < closeList.length; x++) {//------------------当前循环九宫格格子是否已记录在确认数组\r\n\t\t\t    \t\t\tif (checkTarget.x == closeList[x].x && checkTarget.y == closeList[x].y) {\r\n\t\t\t    \t\t\t\tisClose = 1;\r\n\t\t\t    \t\t\t\tbreak;\r\n\t\t\t    \t\t\t}\r\n\t\t\t    \t\t}\r\n\t\t    \t\t\tfor (let x = 0; x < openList.length; x++) {//-------------------当前循环九宫格格子是否已记录在临时数组\r\n\t\t\t    \t\t\tif (checkTarget.x == openList[x].x && checkTarget.y == openList[x].y) {\r\n\t\t\t    \t\t\t\tisOpen = 1;\r\n\t\t\t    \t\t\t\tbreak;\r\n\t\t\t    \t\t\t}\r\n\t\t\t    \t\t}\r\n\t\t    \t\t\tfor (let o = 0; o < obsExList.length; o++) {//------------------当前循环九宫格格子是否位于障碍物格子上下左右侧的格子位置上，是的话就不能纳入赋值ghf处理\r\n\t    \t\t\t\t\tif (checkTarget.x == obsExList[o].x && checkTarget.y == obsExList[o].y) {\r\n\t\t    \t\t\t\t\tisObsEx = 1;\r\n\t\t    \t\t\t\t\tbreak;\r\n\t\t    \t\t\t\t}\r\n\t    \t\t\t\t}\r\n\t\t    \t\t\tfor (let o = 0; o < tempEnemyList.length; o++) {//------------------当前循环九宫格格子是否位于障碍物格子上下左右侧的格子位置上，是的话就不能纳入赋值ghf处理\r\n\t    \t\t\t\t\tif (checkTarget.x == tempEnemyList[o].x && checkTarget.y == tempEnemyList[o].y) {\r\n\t\t    \t\t\t\t\tisEnemy2 = 1;\r\n\t\t    \t\t\t\t\tbreak;\r\n\t\t    \t\t\t\t}\r\n\t    \t\t\t\t}\r\n\t    \t\t\t}\r\n\t    \t\t\tif (isClose == 0 && isOpen == 0 && isObstacle == 0 && isObsEx == 0 && !isEnemy && isEnemy2 == 0) {//-------------如任何检查判断为未触发，则视为当前格子是新处理格子\r\n\t\t\t\t\t\tlet H_x = Math.abs(tempEndTarget.x - checkTarget.x);\r\n\t\t\t\t\t\tlet H_y = Math.abs(tempEndTarget.y - checkTarget.y);\r\n\t\t\t\t\t\tlet H = (H_x + H_y) * 10;\r\n\t\t\t\t\t\tlet G;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif(i == 0 || i == 2 || i == 4 || i == 6){\r\n\t\t\t\t\t\t\tG = 10 + parent.G;\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tG = 14 + parent.G;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlet item = {\r\n\t\t\t\t\t\t\tx: checkTarget.x,\r\n\t\t\t\t\t\t\ty: checkTarget.y,\r\n\t\t\t\t    \t\tG: G,//--------------------------------从起点 A 移动到指定方格的移动代价，沿着到达该方格而生成的路径。\r\n\t\t\t\t    \t\tH: H,//--------------------------------从指定的方格移动到终点 B 的估算成本\r\n\t\t\t\t    \t\tF: G+H,\r\n\t\t\t\t    \t\tdirection: directionList[i].direction\r\n\t\t\t\t\t\t}\r\n\t\t\t\t        let label_G = new cc.Node();\r\n\t\t\t\t        label_G.addComponent(cc.Label);\r\n\t\t\t\t        label_G.getComponent(cc.Label).fontSize = 12\r\n\t\t\t\t        label_G.getComponent(cc.Label).string = (checkTarget.y + \"\" + checkTarget.x)+ \"，F：\"+(G+H)+  \"\\nG:\"+G+\"，H:\"+H;\r\n\t\t\t\t        tempCheckTarget.addChild(label_G);\r\n\t\t\t\t\t\topenList.push(item);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t    \tif (openList[0].isStart == 1) {//-----------处理起点的首次增删数组操作\r\n\t    \t\tcloseList.push(openList[0]);\r\n\t\t\t\topenList.splice(0,1);\r\n\t\t\t\tj = -1;//-------------------------------初始化循环次数\r\n\t    \t}\r\n\t    \tfor (let i = 0; i < openList.length; i++) {//----------循环取F值最小值\r\n\t    \t\tif (openList[i] && minF == 0) {//------------------------为了排除可能会遇到没F值的父格子，当存在的F值的循环才初始化\r\n\t    \t\t\tminF = openList[i];\r\n\t    \t\t}\r\n\t    \t\tif (minF.F > openList[i].F) {\r\n\t    \t\t\tminF = openList[i];\r\n\t    \t\t}\r\n\t    \t}\r\n\t    \tfor (let i = 0; i < openList.length; i++) {//----------依靠最新的F值最小值格子得出新的父节点\r\n\t    \t\tif (openList[i].F == minF.F) {\r\n\t    \t\t\tparent = openList[i];\r\n\t    \t\t\tcloseList.push(openList[i]);\r\n\t    \t\t\topenList.splice(i,1);\r\n\t    \t\t\tj = -1;//-------------------------------初始化循环次数\r\n\t    \t\t\tminF = 0;//-----------初始化F值最小值\r\n\t    \t\t}\r\n\t    \t}\r\n\t    \tif (parent.x == tempEndTarget.x && parent.y == tempEndTarget.y) {//---------------如果临时确认数组收录了终点，就退出循环\r\n\t\t\t\tisSure_start = 1;\r\n\t\t\t}\r\n    \t}\r\n\t\tfor (let j = 0; j < closeList.length; j++) {\r\n\t\t\tthis.batBox.getChildByName(\"batBox_y\" + closeList[j].y + \"_x\" + closeList[j].x).setColor(cc.color(\"#008102\"));//-----测试阶段，上颜色标识用\r\n\t\t}\r\n\t\tcloseList = closeList.reverse();\r\n\t\tsureList.push(parent);\r\n\t\t//计算最终路线    原理：从临时确认数组中反过来走到起点\r\n\t\tfor (let j = 0; j < closeList.length; j++) {\r\n\t\t\tif (isSure_end == 1) { break; }//----------已回到起点，退出循环\r\n\t\t\tlet obsExList = [];//--------------障碍物上下左右格子的数组\r\n    \t\tlet obsId_right = null;//----------当前障碍物格子的右侧格子--临时禁止加入临时数组\r\n    \t\tlet obsId_down = null;//-----------当前障碍物格子的下侧格子--临时禁止加入临时数组\r\n    \t\tlet obsId_left = null;//-----------当前障碍物格子的左侧格子--临时禁止加入临时数组\r\n    \t\tlet obsId_top = null;//------------当前障碍物格子的上侧格子--临时禁止加入临时数组\r\n    \t\tlet tempSureList = [];\r\n    \t\t\r\n\t    \tvar tempEnemyList = [];\r\n    \t\tlet enemId_right = null;//----------当前敌人格子的右侧格子--临时禁止加入临时数组\r\n    \t\tlet enemId_down = null;//-----------当前敌人格子的下侧格子--临时禁止加入临时数组\r\n    \t\tlet enemId_left = null;//-----------当前敌人格子的左侧格子--临时禁止加入临时数组\r\n    \t\tlet enemId_top = null;//------------当前敌人格子的上侧格子--临时禁止加入临时数组\r\n\t\t\tconsole.log(j+\"——————————————————————————————————————————————————\");\r\n\t\t\tfor (let i = 0; i < directionList.length; i++) {\r\n\t\t\t\t//获取当前循环的父节点格子  \r\n\t    \t\tlet tempCheckTarget = this.batBox.getChildByName(\"batBox_y\" + (parent.y + directionList[i].y) + \"_x\" + (parent.x + directionList[i].x));\r\n\t    \t\tif (tempCheckTarget) {//----------是否存在格子\r\n\t\t\t\t\tvar checkTarget = tempCheckTarget.getComponent(\"batBox_basic\");\r\n\t    \t\t\tif (checkTarget.bat_obstacle) {//---------------------当前循环九宫格格子是障碍物\r\n\t    \t\t\t\tif (i == 0 || i == 2 || i == 4 || i == 6) {\r\n\t    \t\t\t\t\tobsId_right = {y:(checkTarget.y + directionList[0].y),x:(checkTarget.x + directionList[0].x)};\r\n\t    \t\t\t\t\tobsId_down = {y:(checkTarget.y + directionList[2].y),x:(checkTarget.x + directionList[2].x)};\r\n\t    \t\t\t\t\tobsId_left = {y:(checkTarget.y + directionList[4].y),x:(checkTarget.x + directionList[4].x)};\r\n\t    \t\t\t\t\tobsId_top = {y:(checkTarget.y + directionList[6].y),x:(checkTarget.x + directionList[6].x)};\r\n\t    \t\t\t\t\tobsExList.push(obsId_right,obsId_down,obsId_left,obsId_top);\r\n\t    \t\t\t\t}\r\n\t    \t\t\t}\r\n\t    \t\t}\r\n    \t\t\tvar enemyList2 = [];\r\n    \t\t\tfor (var z = 0; z < this.hero_list.length; z++) {\r\n    \t\t\t\tif(this.hero_list[z].point == checkTarget.bat_hero.point && this.hero_list[z].groupId == 2){\r\n    \t\t\t\t\tenemyList2.push(this.hero_list[z]);\r\n    \t\t\t\t}\r\n    \t\t\t}\r\n    \t\t\tif (enemyList2) {\r\n    \t\t\t\tif (i == 0 || i == 2 || i == 4 || i == 6) {\r\n    \t\t\t\t\tenemId_right = {y:(checkTarget.y + directionList[0].y),x:(checkTarget.x + directionList[0].x)};\r\n    \t\t\t\t\tenemId_down = {y:(checkTarget.y + directionList[2].y),x:(checkTarget.x + directionList[2].x)};\r\n    \t\t\t\t\tenemId_left = {y:(checkTarget.y + directionList[4].y),x:(checkTarget.x + directionList[4].x)};\r\n    \t\t\t\t\tenemId_top = {y:(checkTarget.y + directionList[6].y),x:(checkTarget.x + directionList[6].x)};\r\n    \t\t\t\t\ttempEnemyList.push(enemId_right,enemId_down,enemId_left,enemId_top);\r\n    \t\t\t\t}\r\n    \t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (let i = 0; i < directionList.length; i++) {\r\n\t    \t\tlet isClose = 0;//-----------------是否已记录在确认数组标识   0：不是   1：是\r\n\t    \t\tlet isObstacle = 0;//--------------是否障碍物   0：不是   1：是\r\n\t    \t\tlet isObsEx = 0;//-----------------当前格子是否位于障碍物格子上下左右侧的格子位置上，用于判断是否处于斜格处理   0：不是   1：是\r\n\t\t\t\tvar isEnemy = false;\r\n\t    \t\tvar isEnemy2 = 0;\r\n\t\t\t\tlet tempCheckTarget = this.batBox.getChildByName(\"batBox_y\" + (parent.y + directionList[i].y) + \"_x\" + (parent.x + directionList[i].x));\r\n\t    \t\tif (tempCheckTarget) {//----------是否存在格子\r\n\t    \t\t\tvar checkTarget = tempCheckTarget.getComponent(\"batBox_basic\");\r\n\t    \t\t\tif (checkTarget.bat_obstacle) {//---------------------当前循环九宫格格子是障碍物\r\n\t    \t\t\t\tisObstacle = 1;\r\n\t    \t\t\t}else if(enemyList2.length != 0){\r\n\t    \t\t\t\tisEnemy = true;\r\n\t    \t\t\t}else{\r\n\t    \t\t\t\tfor (let x = 0; x < closeList.length; x++) {//------------------当前循环九宫格格子是否已记录在确认数组\r\n\t\t\t    \t\t\tif (checkTarget.x == closeList[x].x && checkTarget.y == closeList[x].y) {\r\n\t\t\t    \t\t\t\tfor (let o = 0; o < obsExList.length; o++) {//------------------当前循环九宫格格子是否位于障碍物格子上下左右侧的格子位置上，是的话就不能纳入赋值ghf处理\r\n\t\t\t    \t\t\t\t\tif (checkTarget.x == obsExList[o].x && checkTarget.y == obsExList[o].y) {\r\n\t\t\t\t    \t\t\t\t\tisObsEx = 1;\r\n\t\t\t\t    \t\t\t\t\tbreak;\r\n\t\t\t\t    \t\t\t\t}\r\n\t\t\t    \t\t\t\t}\r\n\t\t\t\t    \t\t\tfor (let o = 0; o < tempEnemyList.length; o++) {//------------------当前循环九宫格格子是否位于障碍物格子上下左右侧的格子位置上，是的话就不能纳入赋值ghf处理\r\n\t\t\t    \t\t\t\t\tif (checkTarget.x == tempEnemyList[o].x && checkTarget.y == tempEnemyList[o].y) {\r\n\t\t\t\t    \t\t\t\t\tisEnemy2 = 1;\r\n\t\t\t\t    \t\t\t\t\tbreak;\r\n\t\t\t\t    \t\t\t\t}\r\n\t\t\t    \t\t\t\t}\r\n\t\t\t    \t\t\t\tif (isObsEx == 0 && isEnemy2 == 0) {\r\n\t\t\t    \t\t\t\t\ttempSureList.push(closeList[x]);\r\n\t\t\t    \t\t\t\t}\r\n\t\t\t    \t\t\t}\r\n\t\t\t    \t\t}\r\n\t    \t\t\t}\r\n\t    \t\t}\r\n\t\t\t}\r\n\t\t\tfor (let i = 0; i < tempSureList.length; i++) {//----------循环取F值最小值\r\n\t    \t\tif (tempSureList[i] && minG == 0) {//------------------------为了排除可能会遇到没G值的父格子，当存在的G值的循环才初始化\r\n\t    \t\t\tminG = tempSureList[i];\r\n\t    \t\t}\r\n\t    \t\tif (minG.G > tempSureList[i].G) {\r\n\t    \t\t\tminG = tempSureList[i];\r\n\t    \t\t}\r\n\t    \t}\r\n\t    \tfor (let i = 0; i < tempSureList.length; i++) {//----------依靠最新的G值最小值格子得出新的父节点\r\n\t    \t\tif (tempSureList[i].G == minG.G) {\r\n\t    \t\t\tparent = tempSureList[i];\r\n\t    \t\t\tsureList.push(tempSureList[i]);\r\n\t    \t\t\tminG = 0;//-----------初始化G值最小值\r\n\t    \t\t}\r\n\t    \t}\r\n\t\t\tif (parent.x == startTarget.x && parent.y == startTarget.y) {//---------------如果临时确认数组收录了起点，就退出循环\r\n\t\t\t\tisSure_end = 1;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (let j = 0; j < sureList.length; j++) {\r\n\t\t\tthis.batBox.getChildByName(\"batBox_y\" + sureList[j].y + \"_x\" + sureList[j].x).setColor(cc.color(\"#bbb\"));//-----测试阶段，上颜色标识用\r\n\t\t}\r\n\t\t//console.log(sureList,closeList);\r\n\t\treturn sureList.reverse();\r\n    },\r\n    //获取最近敌人\r\n    getNearEnemy: function(target,dataList){\r\n    \tlet tempList = [];\r\n    \tlet enemyList = [];\r\n    \tvar minF = 0;\r\n    \tfor (let i = 0; i < dataList.length; i++) {\r\n    \t\tif (dataList[i].groupId == 2) {\r\n\t\t    \tlet H_x = Math.abs(dataList[i].x - target.x);\r\n\t\t\t\tlet H_y = Math.abs(dataList[i].y - target.y);\r\n\t\t\t\tlet H = (H_x + H_y) * 10;\r\n\t\t\t\tlet G = 0;\r\n\t\t\t\tlet item = {\r\n\t\t\t\t\tx: dataList[i].x,\r\n\t\t\t\t\ty: dataList[i].y,\r\n\t\t    \t\tG: G,//--------------------------------从起点 A 移动到指定方格的移动代价，沿着到达该方格而生成的路径。\r\n\t\t    \t\tH: H,//--------------------------------从指定的方格移动到终点 B 的估算成本\r\n\t\t    \t\tF: G+H\r\n\t\t\t\t}\r\n\t\t\t\ttempList.push(item);\r\n    \t\t\tenemyList.push(dataList[i]);\r\n    \t\t}\r\n    \t}\r\n    \tfor (let i = 0; i < tempList.length; i++) {\r\n    \t\tif (tempList[i].F && minF == 0) {//------------------------为了排除可能会遇到没F值的父格子，当存在的F值的循环才初始化\r\n    \t\t\tminF = tempList[i];\r\n    \t\t}\r\n    \t\tif (minF.F > tempList[i].F) {\r\n    \t\t\tminF = tempList[i];\r\n    \t\t}\r\n    \t}\r\n    \treturn minF;\r\n    },\r\n});\r\n"]}